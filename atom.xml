<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Originalee的博客</title>
  <subtitle>打篮球的程序员</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2017-07-20T00:15:06.000Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>Originalee</name>
    <email>xiao.liunit@gmail.com</email>
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>数据结构——链表的游标实现(C语言)</title>
    <link href="http://yoursite.com/2017/07/20/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E9%93%BE%E8%A1%A8%E7%9A%84%E6%B8%B8%E6%A0%87%E5%AE%9E%E7%8E%B0-C%E8%AF%AD%E8%A8%80/"/>
    <id>http://yoursite.com/2017/07/20/数据结构——链表的游标实现-C语言/</id>
    <published>2017-07-20T00:14:12.000Z</published>
    <updated>2017-07-20T00:15:06.000Z</updated>
    
    <content type="html"><![CDATA[<p>上一篇博文我们用指针实现了链表，但是诸如BASIC和FORTRAN等许多语言都不支持指针。如果需要链表而又不能使用指针，这时我们可以使用游标（cursor）实现法来实现链表。</p>
<p>在链表的实现中有两个重要的特点：</p>
<ul>
<li><p>数据存储在一组结构体中。每一个结构体包含有数据以及指向下一个结构体的指针。</p>
</li>
<li><p>一个新的结构体可以通过调用malloc而从系统全局内存（global memory）得到，并可以通过free而被释放。</p>
</li>
</ul>
<p>游标法必须能够模仿实现这两条特性 。 下面给出实现代码:</p>
<a id="more"></a>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> _CursorList_H</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> PtrToNode;</div><div class="line"><span class="keyword">typedef</span> PtrToNode List;</div><div class="line"><span class="keyword">typedef</span> PtrToNode Position;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> ElementType;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">InitializeCursorSpace</span><span class="params">( <span class="keyword">void</span> )</span></span>;</div><div class="line"></div><div class="line"><span class="function">List <span class="title">MakeEmpty</span><span class="params">( List L )</span></span>;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">IsEmpty</span><span class="params">( <span class="keyword">const</span> List L )</span></span>;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">IsLast</span><span class="params">( <span class="keyword">const</span> Position P, <span class="keyword">const</span> List L )</span></span>;</div><div class="line"><span class="function">Position <span class="title">Find</span><span class="params">( ElementType X, <span class="keyword">const</span> List L )</span></span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Delete</span><span class="params">( ElementType X, List L )</span></span>;</div><div class="line"><span class="function">Position <span class="title">FindPrevious</span><span class="params">( ElementType X, <span class="keyword">const</span> List L)</span></span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span><span class="params">( ElementType X, List L, Position P )</span></span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">DeleteList</span><span class="params">( <span class="keyword">const</span> List L )</span></span>;</div><div class="line"><span class="function">Position <span class="title">Header</span><span class="params">( <span class="keyword">const</span> List L )</span></span>;</div><div class="line"><span class="function">Position <span class="title">First</span><span class="params">( <span class="keyword">const</span> List L)</span></span>;</div><div class="line"><span class="function">Position <span class="title">Advance</span><span class="params">( <span class="keyword">const</span> Position P )</span></span>;</div><div class="line"><span class="function">ElementType <span class="title">Retrieve</span><span class="params">( <span class="keyword">const</span> Position P )</span></span>;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">/*_CUrsor_H */</span></span></div></pre></td></tr></table></figure>
<p>可以从上面的代码上看到，链表的游标实现跟链表的接口定义几乎是一样的。</p>
<p>下面放上实现代码:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"CursorList.h"</span></span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> OK 1</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ERROR 0</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> TRUE 1</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FALSE 0</span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> SpaceSize 10</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> Status;</div><div class="line"></div><div class="line"><span class="keyword">struct</span> Node</div><div class="line">&#123;</div><div class="line">    ElementType Element;</div><div class="line">    Position Next;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">struct</span> Node CursorSpace[ SpaceSize ];</div><div class="line"></div><div class="line"><span class="comment">/* initialize the CursorSpace */</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">InitCursorSpace</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> i;</div><div class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; SpaceSize; i++)</div><div class="line">        CursorSpace[i].Next = i == SpaceSize<span class="number">-1</span> ? <span class="number">0</span> : i+<span class="number">1</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">static</span> Position <span class="title">CursorAlloc</span><span class="params">(<span class="keyword">void</span>)</span></span></div><div class="line">&#123;</div><div class="line">    Position P;</div><div class="line"></div><div class="line">    P = CursorSpace[<span class="number">0</span>].Next;</div><div class="line">    CursorSpace[<span class="number">0</span>].Next = CursorSpace[P].Next;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> P;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">CursorFree</span><span class="params">(Position P)</span></span></div><div class="line">&#123;</div><div class="line">    CursorSpace[P].Next = CursorSpace[<span class="number">0</span>].Next;</div><div class="line">    CursorSpace[<span class="number">0</span>].Next = P;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/* Return true if L is empty */</span></div><div class="line"><span class="function">Status <span class="title">IsEmpty</span><span class="params">(List L)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (CursorSpace[L].Next == <span class="number">0</span>)</div><div class="line">        <span class="keyword">return</span> TRUE;</div><div class="line">    <span class="keyword">else</span></div><div class="line">        <span class="keyword">return</span> FALSE;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/* Return true if P is the last position in list L */</span></div><div class="line"><span class="comment">/* Parameter L is unused in this implementation */</span></div><div class="line"><span class="function">Status <span class="title">IsLast</span><span class="params">(Position P, List L)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (CursorSpace[P].Next == <span class="number">0</span>)</div><div class="line">        <span class="keyword">return</span> TRUE;</div><div class="line">    <span class="keyword">else</span></div><div class="line">        <span class="keyword">return</span> FALSE;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/* Return Position of X in L; 0 if not found */</span></div><div class="line"><span class="comment">/* Uses a header node */</span></div><div class="line"><span class="function">Position <span class="title">Find</span><span class="params">(ElementType X, List L)</span></span></div><div class="line">&#123;</div><div class="line">    Position P;</div><div class="line"></div><div class="line">    P = CursorSpace[L].Next;</div><div class="line">    <span class="keyword">while</span>(P &amp;&amp; CursorSpace[P].Element != X) &#123;</div><div class="line">        P = CursorSpace[P].Next;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> P;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/* Delete first occurrence of X from a list */</span></div><div class="line"><span class="comment">/* Assume use of a header node */</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Delete</span><span class="params">(ElementType X, List L)</span></span></div><div class="line">&#123;</div><div class="line">    Position P, TmpCell;</div><div class="line"></div><div class="line">    P = FindPrevious(X, L);</div><div class="line">    <span class="keyword">if</span> (!IsLast(P, L))</div><div class="line">        TmpCell = CursorSpace[P].Next;</div><div class="line">        CursorSpace[P].Next = CursorSpace[TmpCell].Next;</div><div class="line">        CursorFree(TmpCell);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/* Find the front of the first X of The list */</span></div><div class="line"><span class="comment">/* Return 0 if not found */</span></div><div class="line"><span class="function">Position <span class="title">FindPrevious</span><span class="params">(ElementType X, <span class="keyword">const</span> List L)</span></span></div><div class="line">&#123;</div><div class="line">    Position P;</div><div class="line">    P = L;</div><div class="line">    <span class="keyword">while</span>(P &amp;&amp; CursorSpace[CursorSpace[P].Next].Element != X)</div><div class="line">    &#123;</div><div class="line">        P = CursorSpace[P].Next;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> P;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/* Insert(after legal position P) */</span></div><div class="line"><span class="comment">/* Header implementation assumed */</span></div><div class="line"><span class="comment">/* Parameter L is unused in this implemention */</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span><span class="params">(ElementType X, List L, Position P)</span></span></div><div class="line">&#123;</div><div class="line">    Position TmpCell;</div><div class="line"></div><div class="line">    TmpCell = CursorAlloc();</div><div class="line">    <span class="keyword">if</span> (TmpCell == <span class="number">0</span>)</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Out of space!\n"</span>);</div><div class="line">    CursorSpace[TmpCell].Element = X;</div><div class="line">    CursorSpace[TmpCell].Next = CursorSpace[P].Next;</div><div class="line">    CursorSpace[P].Next = TmpCell;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_list</span><span class="params">(List L)</span></span></div><div class="line">&#123;</div><div class="line">    List p = L;</div><div class="line">    <span class="keyword">if</span> (<span class="literal">NULL</span> == p)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"print_list: 链表为空!\n"</span>);</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    Position P;</div><div class="line"></div><div class="line">    P = CursorSpace[L].Next;</div><div class="line">    <span class="keyword">while</span>(P != <span class="literal">NULL</span>) &#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d, \n"</span>, CursorSpace[P].Element);</div><div class="line">        P = CursorSpace[P].Next;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"\n"</span>);</div><div class="line">    <span class="keyword">return</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> <span class="keyword">const</span> *argv[])</span></span></div><div class="line">&#123;</div><div class="line">    InitCursorSpace();</div><div class="line">    List L = CursorAlloc();</div><div class="line">    CursorSpace[L].Next = <span class="literal">NULL</span>;</div><div class="line">    Insert(<span class="number">1</span>, L, L);</div><div class="line">    Insert(<span class="number">0</span>, L, L);</div><div class="line">    Insert(<span class="number">21</span>, L, L);</div><div class="line">    Insert(<span class="number">1201</span>, L, L);</div><div class="line">    Position P;</div><div class="line">    P = Find(<span class="number">21</span>, L);</div><div class="line">    <span class="keyword">if</span> (P)</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"找到元素: %d\n"</span>, CursorSpace[P].Element);</div><div class="line">    <span class="keyword">else</span></div><div class="line">        <span class="built_in">printf</span>(<span class="string">"未找到21元素\n"</span>);</div><div class="line">    Delete(<span class="number">0</span>, L);</div><div class="line">    Delete(<span class="number">1</span>, L);</div><div class="line">    print_list(L);</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"检查链表是否为空: %d\n"</span>, IsEmpty(L));</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"Hello World\n"</span>);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>实现过程比较简单，最后的main函数是对游标链表的测试。代码直接开箱即用，可以看到测试过程。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;上一篇博文我们用指针实现了链表，但是诸如BASIC和FORTRAN等许多语言都不支持指针。如果需要链表而又不能使用指针，这时我们可以使用游标（cursor）实现法来实现链表。&lt;/p&gt;
&lt;p&gt;在链表的实现中有两个重要的特点：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;数据存储在一组结构体中。每一个结构体包含有数据以及指向下一个结构体的指针。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;一个新的结构体可以通过调用malloc而从系统全局内存（global memory）得到，并可以通过free而被释放。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;游标法必须能够模仿实现这两条特性 。 下面给出实现代码:&lt;/p&gt;
    
    </summary>
    
    
      <category term="数据结构" scheme="http://yoursite.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
      <category term="链表" scheme="http://yoursite.com/tags/%E9%93%BE%E8%A1%A8/"/>
    
  </entry>
  
  <entry>
    <title>数据结构——链表(C语言实现)</title>
    <link href="http://yoursite.com/2017/07/16/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E9%93%BE%E8%A1%A8(C%E8%AF%AD%E8%A8%80%E5%AE%9E%E7%8E%B0)/"/>
    <id>http://yoursite.com/2017/07/16/数据结构——链表(C语言实现)/</id>
    <published>2017-07-16T13:25:01.000Z</published>
    <updated>2017-07-16T13:33:37.000Z</updated>
    
    <content type="html"><![CDATA[<p>提起链表，我们每个人都不会陌生，不管对数据结构的掌握如何，都或多或少的听过与用过链表这样的常见的数据结构。链表是线性表的一种，最基础的线性表，在插入与删除数据时，我们需要对表的整体或部分做移动，为了允许表可以不按照线性的顺序存储数据结构，于是链表就应运而生。链表最大的特点就是在每个节点里存储了到下一个节点的指针。由于不必按照顺序存储，链表在插入的时候可以达到O(1)的复杂度，比我们学习的最基本的线性表要快得多。但是在查找一个节点，或者访问特定编号的结点则需要O(N)的时间。</p>
<p>使用链表结构可以克服数组链表需要预先知道数据大小的缺点，链表结构可以充分利用计算机内存空间，实现灵活的内存动态管理。但是链表失去了数组随机读取的有点，同时由于增加了指针域，空间开销较大。不过这在算法与数据结构领域是很常见的，用空间换时间，毕竟鱼和熊掌不可兼得。</p>
<p>我的链表数据结构是使用C语言来实现的，那么下面来看一下链表的头文件定义了哪些操作。</p>
<a id="more"></a>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> _List_H</span></div><div class="line"></div><div class="line"><span class="keyword">struct</span> Node;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> Node *PtrToNode;</div><div class="line"><span class="keyword">typedef</span> PtrToNode List;</div><div class="line"><span class="keyword">typedef</span> PtrToNode Position;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> ElementType;</div><div class="line"></div><div class="line"><span class="function">List <span class="title">MakeEmpty</span><span class="params">(List L)</span></span>;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">IsEmpty</span><span class="params">(List L)</span></span>;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">IsLast</span><span class="params">(Position P, List L)</span></span>;</div><div class="line"><span class="function">Position <span class="title">Find</span><span class="params">(ElementType X, List L)</span></span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Delete</span><span class="params">( ElementType X, List L)</span></span>;</div><div class="line"><span class="function">Position <span class="title">FindPrevious</span><span class="params">( ElementType X, List L)</span></span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span><span class="params">( ElementType X, List L, Position P)</span></span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">DeleteList</span><span class="params">( List L )</span></span>;</div><div class="line"><span class="function">Position <span class="title">Header</span><span class="params">( List L )</span></span>;</div><div class="line"><span class="function">Position <span class="title">First</span><span class="params">( List L)</span></span>;</div><div class="line"><span class="function">Position <span class="title">Advance</span><span class="params">( Position P )</span></span>;</div><div class="line"><span class="function">ElementType <span class="title">Retrieve</span><span class="params">( Position P )</span></span>;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">endif</span> <span class="comment">/* _List_H */</span></span></div></pre></td></tr></table></figure>
<p>下面是对于头结点的实现文件，末尾的<code>main</code>函数中还有针对各类函数的测试方法。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"List.h"</span></span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> OK 1</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ERROR 0</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> TRUE 1</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FALSE 0</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> Status;</div><div class="line"></div><div class="line"><span class="keyword">struct</span> Node</div><div class="line">&#123;</div><div class="line">    ElementType Element;</div><div class="line">    Position Next;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init_list</span><span class="params">(List L)</span></span></div><div class="line">&#123;</div><div class="line">    L = <span class="literal">NULL</span>;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"初始化链表成功\n"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function">List <span class="title">create_list</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    List L = <span class="literal">NULL</span>;</div><div class="line">    List p1, p2;</div><div class="line">    p1 = (List)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> Node));</div><div class="line">    p2 = (List)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> Node));</div><div class="line">    <span class="keyword">if</span> (p1 == <span class="literal">NULL</span> || p2 == <span class="literal">NULL</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"内存分配失败!\n"</span>);</div><div class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</div><div class="line">        system(<span class="string">"pause"</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">memset</span>(p1, <span class="number">0</span>, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> Node));</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"请输入链表元素的值: \n"</span>);</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;(p1-&gt;Element));</div><div class="line">    p1-&gt;Next = <span class="literal">NULL</span>;</div><div class="line">    <span class="keyword">while</span>(p1-&gt;Element &gt; <span class="number">0</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">if</span> (L == <span class="literal">NULL</span>)</div><div class="line">        &#123;</div><div class="line">            L = p1;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span></div><div class="line">        &#123;</div><div class="line">            p2-&gt;Next = p1;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        p2 = p1;</div><div class="line"></div><div class="line">        p1 = (List)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> Node));</div><div class="line">        <span class="keyword">if</span> (p1 == <span class="literal">NULL</span> || p2 == <span class="literal">NULL</span>)</div><div class="line">        &#123;</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"内存分配失败\n"</span>);</div><div class="line">            <span class="built_in">exit</span>(<span class="number">0</span>);</div><div class="line">            system(<span class="string">"pause"</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">memset</span>(p1, <span class="number">0</span>, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> Node));</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"请输入链表的值: \n"</span>);</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;(p1-&gt;Element));</div><div class="line">        p1-&gt;Next = <span class="literal">NULL</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"创建链表成功\n"</span>);</div><div class="line">    <span class="keyword">return</span> L;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_list</span><span class="params">(List L)</span></span></div><div class="line">&#123;</div><div class="line">    List p = L;</div><div class="line">    <span class="keyword">if</span> (<span class="literal">NULL</span> == p)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"print_list: 链表为空!\n"</span>);</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="built_in">printf</span>(<span class="string">"打印链表如下: \n"</span>);</div><div class="line">    <span class="keyword">while</span>(p != <span class="literal">NULL</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d, \n"</span>, p-&gt;Element);</div><div class="line">        p = p-&gt;Next;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"\n"</span>);</div><div class="line">    <span class="keyword">return</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function">Status <span class="title">IsEmpty</span><span class="params">(List L)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (L == <span class="literal">NULL</span>)</div><div class="line">        <span class="keyword">return</span> TRUE;</div><div class="line">    <span class="keyword">else</span></div><div class="line">        <span class="keyword">return</span> FALSE;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function">Status <span class="title">IsLast</span><span class="params">(Position P, List L)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">return</span> P-&gt;Next == <span class="literal">NULL</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function">Position <span class="title">Find</span><span class="params">(ElementType X, List L)</span></span></div><div class="line">&#123;</div><div class="line">    Position P;</div><div class="line">    P = L-&gt;Next;</div><div class="line">    <span class="keyword">while</span>(P != <span class="literal">NULL</span> &amp;&amp; P-&gt;Element != X)</div><div class="line">    &#123;</div><div class="line">        P = P-&gt;Next;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> P;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Delete</span><span class="params">(ElementType X, List L)</span></span></div><div class="line">&#123;</div><div class="line">    Position P, TmpCell;</div><div class="line"></div><div class="line">    P = FindPrevious(X, L);</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (!IsLast(P, L))</div><div class="line">        TmpCell = P-&gt;Next;</div><div class="line">        P-&gt;Next = TmpCell-&gt;Next;</div><div class="line">        <span class="built_in">free</span>(TmpCell);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function">Position <span class="title">FindPrevious</span><span class="params">(ElementType X, List L)</span></span></div><div class="line">&#123;</div><div class="line">    Position P;</div><div class="line"></div><div class="line">    P = L;</div><div class="line">    <span class="keyword">while</span>(P-&gt;Next != <span class="literal">NULL</span> &amp;&amp; P-&gt;Next-&gt;Element != X)</div><div class="line">    &#123;</div><div class="line">        P = P-&gt;Next;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> P;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span><span class="params">(ElementType X, List L, Position P)</span></span></div><div class="line">&#123;</div><div class="line">    Position TmpCell;</div><div class="line"></div><div class="line">    TmpCell = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> Node));</div><div class="line">    <span class="keyword">if</span> (TmpCell == <span class="literal">NULL</span>)</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Out of space!!!\n"</span>);</div><div class="line">    TmpCell-&gt;Element = X;</div><div class="line">    TmpCell-&gt;Next = P-&gt;Next;</div><div class="line">    P-&gt;Next = TmpCell;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">DeleteList</span><span class="params">(List L)</span></span></div><div class="line">&#123;</div><div class="line">    Position P, Tmp;</div><div class="line"></div><div class="line">    P = L-&gt;Next;</div><div class="line">    L-&gt;Next = <span class="literal">NULL</span>;</div><div class="line"></div><div class="line">    <span class="keyword">while</span>(P != <span class="literal">NULL</span>)</div><div class="line">    &#123;</div><div class="line">        Tmp = P-&gt;Next;</div><div class="line">        <span class="built_in">free</span>(P);</div><div class="line">        P = Tmp;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> <span class="keyword">const</span> *argv[])</span></span></div><div class="line">&#123;</div><div class="line">    List L;</div><div class="line">    init_list(L);</div><div class="line">    L = create_list();</div><div class="line">    print_list(L);</div><div class="line">    <span class="keyword">int</span> isEmpty = IsEmpty(L);</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"链表是否为空: %d\n"</span>, isEmpty);</div><div class="line">    Position p = Find(<span class="number">21</span>, L);</div><div class="line">    <span class="keyword">if</span> (p == <span class="literal">NULL</span>)</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"没有找到21元素\n"</span>);</div><div class="line">    <span class="keyword">else</span></div><div class="line">        <span class="built_in">printf</span>(<span class="string">"查找21结果: %d\n"</span>, p-&gt;Element);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</div><div class="line">    &#123;</div><div class="line">        Insert(i, L, p);</div><div class="line">    &#125;</div><div class="line">    Delete(<span class="number">21</span>, L);</div><div class="line">    DeleteList(L);</div><div class="line">    print_list(L);</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"Hello world\n"</span>);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;提起链表，我们每个人都不会陌生，不管对数据结构的掌握如何，都或多或少的听过与用过链表这样的常见的数据结构。链表是线性表的一种，最基础的线性表，在插入与删除数据时，我们需要对表的整体或部分做移动，为了允许表可以不按照线性的顺序存储数据结构，于是链表就应运而生。链表最大的特点就是在每个节点里存储了到下一个节点的指针。由于不必按照顺序存储，链表在插入的时候可以达到O(1)的复杂度，比我们学习的最基本的线性表要快得多。但是在查找一个节点，或者访问特定编号的结点则需要O(N)的时间。&lt;/p&gt;
&lt;p&gt;使用链表结构可以克服数组链表需要预先知道数据大小的缺点，链表结构可以充分利用计算机内存空间，实现灵活的内存动态管理。但是链表失去了数组随机读取的有点，同时由于增加了指针域，空间开销较大。不过这在算法与数据结构领域是很常见的，用空间换时间，毕竟鱼和熊掌不可兼得。&lt;/p&gt;
&lt;p&gt;我的链表数据结构是使用C语言来实现的，那么下面来看一下链表的头文件定义了哪些操作。&lt;/p&gt;
    
    </summary>
    
    
      <category term="数据结构" scheme="http://yoursite.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
      <category term="链表" scheme="http://yoursite.com/tags/%E9%93%BE%E8%A1%A8/"/>
    
  </entry>
  
  <entry>
    <title>iOS开发——十六进制字符串与NSData的转化</title>
    <link href="http://yoursite.com/2017/07/07/iOS%E5%BC%80%E5%8F%91%E2%80%94%E2%80%94%E5%8D%81%E5%85%AD%E8%BF%9B%E5%88%B6%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B8%8ENSData%E7%9A%84%E8%BD%AC%E5%8C%96/"/>
    <id>http://yoursite.com/2017/07/07/iOS开发——十六进制字符串与NSData的转化/</id>
    <published>2017-07-07T06:58:42.000Z</published>
    <updated>2017-07-07T06:59:39.000Z</updated>
    
    <content type="html"><![CDATA[<p>最近在完成一个需求时，遇到了<code>NSData</code>类型转换为十六进制的字符串这个需求的函数，在<code>stackoverflow</code>中翻找的时候，给出的答案基本上是如下的:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSString</span>* newStr = [[<span class="built_in">NSString</span> alloc] initWithData:theData encoding:<span class="built_in">NSUTF8StringEncoding</span>];</div><div class="line"></div><div class="line"><span class="comment">// If the data is null-terminated, you should instead use -stringWithUTF8String: to avoid the extra \0 at the end.</span></div><div class="line"></div><div class="line"><span class="built_in">NSString</span>* newStr = [<span class="built_in">NSString</span> stringWithUTF8String:[theData bytes]];</div><div class="line"></div><div class="line"><span class="comment">// (Note that if the input is not properly UTF-8-encoded, you will get nil.)</span></div></pre></td></tr></table></figure>
<a id="more"></a>
<p>Swift的写法</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> newStr = <span class="type">String</span>(data: data, encoding: .utf8)</div><div class="line"><span class="comment">// note that `newStr` is a `String?`, not a `String`.</span></div><div class="line"><span class="comment">// If the data is null-terminated, you could go though the safe way which is remove the that null character, or the unsafe way similar to the Objective-C version above.</span></div><div class="line"></div><div class="line"><span class="comment">// safe way, provided data is \0-terminated</span></div><div class="line"><span class="keyword">let</span> newStr1 = <span class="type">String</span>(data: data.subdata(<span class="keyword">in</span>: <span class="number">0</span> ..&lt; data.<span class="built_in">count</span> - <span class="number">1</span>), encoding: .utf8)</div><div class="line"><span class="comment">// unsafe way, provided data is \0-terminated</span></div><div class="line"><span class="keyword">let</span> newStr2 = data.withUnsafeBytes(<span class="type">String</span>.<span class="keyword">init</span>(utf8String:))</div></pre></td></tr></table></figure>
<p>但是在实际的测试中，并不能完成将NSData转换为NSData中存储的十六进制字符串的功能，所以在最终找到答案之后，决定记录下来，以便下次使用可以快速查找。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">NSData</span> *)convertHexStrToData:(<span class="built_in">NSString</span> *)str &#123;</div><div class="line">    <span class="keyword">if</span> (!str || [str length] == <span class="number">0</span>) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">nil</span>;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="built_in">NSMutableData</span> *hexData = [[<span class="built_in">NSMutableData</span> alloc] initWithCapacity:<span class="number">8</span>];</div><div class="line">    <span class="built_in">NSRange</span> range;</div><div class="line">    <span class="keyword">if</span> ([str length] % <span class="number">2</span> == <span class="number">0</span>) &#123;</div><div class="line">        range = <span class="built_in">NSMakeRange</span>(<span class="number">0</span>, <span class="number">2</span>);</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        range = <span class="built_in">NSMakeRange</span>(<span class="number">0</span>, <span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span> (<span class="built_in">NSInteger</span> i = range.location; i &lt; [str length]; i += <span class="number">2</span>) &#123;</div><div class="line">        <span class="keyword">unsigned</span> <span class="keyword">int</span> anInt;</div><div class="line">        <span class="built_in">NSString</span> *hexCharStr = [str substringWithRange:range];</div><div class="line">        <span class="built_in">NSScanner</span> *scanner = [[<span class="built_in">NSScanner</span> alloc] initWithString:hexCharStr];</div><div class="line">        </div><div class="line">        [scanner scanHexInt:&amp;anInt];</div><div class="line">        <span class="built_in">NSData</span> *entity = [[<span class="built_in">NSData</span> alloc] initWithBytes:&amp;anInt length:<span class="number">1</span>];</div><div class="line">        [hexData appendData:entity];</div><div class="line">        </div><div class="line">        range.location += range.length;</div><div class="line">        range.length = <span class="number">2</span>;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"hexdata: %@"</span>, hexData);</div><div class="line">    <span class="keyword">return</span> hexData;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>传入参数字符串<code>@&quot;400&quot;</code>时，打印出来的是 <code>hexdata: &lt;0400&gt;</code>。十六进制的400就是10进制的1024。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">NSString</span> *)convertDataToHexStr:(<span class="built_in">NSData</span> *)data &#123;</div><div class="line">    <span class="keyword">if</span> (!data || [data length] == <span class="number">0</span>) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="string">@""</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">NSMutableString</span> *string = [[<span class="built_in">NSMutableString</span> alloc] initWithCapacity:[data length]];</div><div class="line">    </div><div class="line">    [data enumerateByteRangesUsingBlock:^(<span class="keyword">const</span> <span class="keyword">void</span> *bytes, <span class="built_in">NSRange</span> byteRange, <span class="built_in">BOOL</span> *stop) &#123;</div><div class="line">        <span class="keyword">unsigned</span> <span class="keyword">char</span> *dataBytes = (<span class="keyword">unsigned</span> <span class="keyword">char</span>*)bytes;</div><div class="line">        <span class="keyword">for</span> (<span class="built_in">NSInteger</span> i = <span class="number">0</span>; i &lt; byteRange.length; i++) &#123;</div><div class="line">            <span class="built_in">NSString</span> *hexStr = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%x"</span>, (dataBytes[i]) &amp; <span class="number">0xff</span>];</div><div class="line">            <span class="keyword">if</span> ([hexStr length] == <span class="number">2</span>) &#123;</div><div class="line">                [string appendString:hexStr];</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                [string appendFormat:<span class="string">@"0%@"</span>, hexStr];</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;];</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> string;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>将上一个🌰的NSData作为参数传入时，返回的字符串为<code>400</code>。转换完成。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;最近在完成一个需求时，遇到了&lt;code&gt;NSData&lt;/code&gt;类型转换为十六进制的字符串这个需求的函数，在&lt;code&gt;stackoverflow&lt;/code&gt;中翻找的时候，给出的答案基本上是如下的:&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt;* newStr = [[&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; alloc] initWithData:theData encoding:&lt;span class=&quot;built_in&quot;&gt;NSUTF8StringEncoding&lt;/span&gt;];&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// If the data is null-terminated, you should instead use -stringWithUTF8String: to avoid the extra \0 at the end.&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt;* newStr = [&lt;span class=&quot;built_in&quot;&gt;NSString&lt;/span&gt; stringWithUTF8String:[theData bytes]];&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// (Note that if the input is not properly UTF-8-encoded, you will get nil.)&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
      <category term="iOS开发" scheme="http://yoursite.com/tags/iOS%E5%BC%80%E5%8F%91/"/>
    
      <category term="Objective-C" scheme="http://yoursite.com/tags/Objective-C/"/>
    
  </entry>
  
  <entry>
    <title>iOS开发——自主设计日志系统</title>
    <link href="http://yoursite.com/2017/06/28/iOS%E5%BC%80%E5%8F%91%E2%80%94%E2%80%94%E8%87%AA%E4%B8%BB%E8%AE%BE%E8%AE%A1%E6%97%A5%E5%BF%97%E7%B3%BB%E7%BB%9F/"/>
    <id>http://yoursite.com/2017/06/28/iOS开发——自主设计日志系统/</id>
    <published>2017-06-28T09:37:01.000Z</published>
    <updated>2017-06-28T09:37:51.000Z</updated>
    
    <content type="html"><![CDATA[<p>好像很久没有写有关iOS的文章了，其实iOS的开发一直都是在进行的，但是最近有需求拓宽知识的宽度，所以一直在接触别的知识，当然啦，移动端开发并不能丢下。</p>
<p>我平时开发的项目监测bug和崩溃的模块都是集成了鹅厂的<code>Bugly</code>系统，毕竟是谁用谁说好的第三方系统。而<code>Bugly</code>主要还是返回的还是崩溃之后的日志，所以如果想在平时的运行中，就能拿到客户手机中的日志怎么办呢。在这个需求的驱使下，便开始着手设计一个日志系统。</p>
<p>需求还是不难的，记录手机操作的内容，如</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">时间|日志级别|类名_函数名_行数|分类|Log内容</div></pre></td></tr></table></figure>
<p>这样的一种日志形式。</p>
<p>因为不希望频繁的读写，所以希望每十条Log生成之后，读写一次。而未写入硬盘的Log保存在内存中。按照天数，每天都有一份日志，并且在客户的手机异常之后，可以将所有日志压缩上传到服务器。需求介绍完了，并不难对不对。</p>
<a id="more"></a>
<p>在Log的生成方面，我的设计是枚举出日志的级别，之后利用Swift的 <code>#function</code> 和 <code>#line</code>等定义，方便的获取函数名和行数，类名我是利用一个对于<code>NSObject</code>的<code>extension</code>来完成的，类似这样：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">NSObject</span> </span>&#123;</div><div class="line">    <span class="keyword">var</span> className: <span class="type">String</span> &#123;</div><div class="line">        <span class="keyword">return</span> <span class="type">String</span>(describing: type(of: <span class="keyword">self</span>)).components(separatedBy: <span class="string">"."</span>).last!</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">var</span> <span class="title">className</span>: <span class="title">String</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="type">String</span>(describing: <span class="keyword">self</span>).components(separatedBy: <span class="string">"."</span>).last!</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>开箱可用，准确获取类名。</p>
<p>生成log的核心函数例如如下这样：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">createLog</span><span class="params">(level: DebugLevel, targetClass: AnyClass, type: OperateType, content: String,  <span class="number">_</span> line: Int = #line, <span class="number">_</span> function: String = #function)</span></span></div><div class="line">-&gt; <span class="type">String</span> &#123;</div><div class="line">    <span class="keyword">let</span> lineStr = <span class="type">String</span>.<span class="keyword">init</span>(format: <span class="string">"line:%d"</span>, line)</div><div class="line">    <span class="keyword">let</span> levelStr = levelToString(level: level)</div><div class="line">    <span class="keyword">let</span> separator = <span class="string">"|"</span></div><div class="line">    <span class="keyword">let</span> classSeparator = <span class="string">"_"</span></div><div class="line">    <span class="keyword">let</span> log: <span class="type">String</span> = <span class="type">Date</span>().<span class="built_in">toString</span>() + separator + levelStr + separator + targetClass.className + classSeparator + function + classSeparator + lineStr + separator + content + <span class="string">"\n"</span></div><div class="line">    <span class="built_in">print</span>(log)</div><div class="line">    <span class="keyword">return</span> log</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>而基于这个函数做一些封装，就能封装出很简便的打印各级别日志的API了。</p>
<p>至此，介绍完Log的生成类： <code>LogGenerator</code>。</p>
<p>之后是对日志的读写，需要有一个文件读写的类，暂定名为<code>LogStorage</code>。</p>
<p>因为文件的读写都是常规的操作，所以代码就不贴出来了。我在这里只是贴出我在<code>LogStorage</code>类里暴露的接口方法</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">protocol</span> <span class="title">LogStorageProtocol</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="comment">/// 获取日志缓存地址</span></div><div class="line">    <span class="comment">///</span></div><div class="line">    <span class="comment">/// - Returns: String</span></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">getCachePath</span><span class="params">()</span></span> -&gt; <span class="type">String</span></div><div class="line"></div><div class="line">    <span class="comment">/// 删除文件</span></div><div class="line">    <span class="comment">///</span></div><div class="line">    <span class="comment">/// - Parameter fileName: String</span></div><div class="line">    <span class="comment">/// - Returns: Bool</span></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">deleteFile</span><span class="params">(fileName: String)</span></span> -&gt; <span class="type">Bool</span></div><div class="line"></div><div class="line">    <span class="comment">/// 清除全部日志缓存</span></div><div class="line">    <span class="comment">///</span></div><div class="line">    <span class="comment">/// - Returns: Bool</span></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">cleanCache</span><span class="params">()</span></span> -&gt; <span class="type">Bool</span></div><div class="line"></div><div class="line">    <span class="comment">/// 读取日志文件</span></div><div class="line">    <span class="comment">///</span></div><div class="line">    <span class="comment">/// - Parameter fileName: String</span></div><div class="line">    <span class="comment">/// - Returns: Data</span></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">readFile</span><span class="params">(fileName: String)</span></span> -&gt; <span class="type">Data</span>?</div><div class="line"></div><div class="line">    <span class="comment">/// 更新写入Log数据</span></div><div class="line">    <span class="comment">///</span></div><div class="line">    <span class="comment">/// - Parameters:</span></div><div class="line">    <span class="comment">///   - fileName: String</span></div><div class="line">    <span class="comment">///   - data: Data</span></div><div class="line">    <span class="comment">/// - Returns: Data</span></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">updateFile</span><span class="params">(fileName: String, data: Data)</span></span> -&gt; <span class="type">Bool</span></div><div class="line"></div><div class="line">    <span class="comment">/// 自动根据天数创建文件名</span></div><div class="line">    <span class="comment">///</span></div><div class="line">    <span class="comment">/// - Returns: String</span></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">createFileName</span><span class="params">()</span></span> -&gt; <span class="type">String</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>而这个十条一写，没有达到标准的就暂时保存在内存里，我的想法是创建一个循环队列，根据FIFO原则，当满足十条Log时，做一次写入操作，而循环队列在空间上是非常节省资源的，如果没有满足十条日志，那就都暂存在队列里，整个开销就是循环队列的一个数组，容量是11个元素，还有一个充当哨兵。</p>
<p>循环队列的数据结构是队列的数据结构里最基础的</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">QueueProtocol</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">createQueue</span><span class="params">()</span></span></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">traverseQueue</span><span class="params">()</span></span></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">isFullQueue</span><span class="params">()</span></span> -&gt; <span class="type">Bool</span></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">isEmptyQueue</span><span class="params">()</span></span> -&gt; <span class="type">Bool</span></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">Enqueue</span><span class="params">(log: String)</span></span> -&gt; <span class="type">Bool</span></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">Dequeue</span><span class="params">()</span></span> -&gt; <span class="type">Bool</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>在内部增加了一个遍历队列写入日志的函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">private func updateFileWhenTranverse() &#123;</div><div class="line">    var i = queue.front</div><div class="line">    while (i != queue.rear) &#123;</div><div class="line">        let fileName = LogStorage.share.createFileName()</div><div class="line">        let data = queue.logData[i].data(using: .utf8)</div><div class="line">        if (LogStorage.share.updateFile(fileName: fileName, data: data!)) &#123;</div><div class="line">            let _ = Dequeue()</div><div class="line">        &#125;</div><div class="line">        i += 1</div><div class="line">        i = i % queue.maxsize</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>而最后一个需求就是压缩上传了，在这里使用了<code>SSZipArchive</code>这个第三方库来压缩文件成zip格式。封装成<code>LogArchive</code>类。是不是三言两语间，整个日志系统就设计完成了，但是我是用<code>Swift</code>来写的，若是<code>Objective-C</code>调用怎么办呢。答案当然是用Objc强大的宏定义来搞定咯，几个宏定义，轻松的一行代码就调用了Log输出。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#define Cute_Debug(log) [[LogGenerator new] debugWithTargetClass:self.classForCoder content:[NSString stringWithFormat:@<span class="meta-string">"%@"</span>, log] :(NSInteger)__LINE__ :[NSString stringWithFormat:@<span class="meta-string">"%s"</span>, __FUNCTION__]];</span></div><div class="line"></div><div class="line"><span class="meta">#define Cute_Warning(log) [[LogGenerator new] warningWithTargetClass:self.classForCoder content:[NSString stringWithFormat:@<span class="meta-string">"%@"</span>, log] :(NSInteger)__LINE__ :[NSString stringWithFormat:@<span class="meta-string">"%s"</span>, __FUNCTION__]];</span></div><div class="line"></div><div class="line"><span class="meta">#define Cute_Info(log) [[LogGenerator new] infoWithTargetClass:self.classForCoder content:[NSString stringWithFormat:@<span class="meta-string">"%@"</span>, log] :(NSInteger)__LINE__ :[NSString stringWithFormat:@<span class="meta-string">"%s"</span>, __FUNCTION__]];</span></div><div class="line"></div><div class="line"><span class="meta">#define Cute_Error(log) [[LogGenerator new] errorWithTargetClass:self.classForCoder content:[NSString stringWithFormat:@<span class="meta-string">"%@"</span>, log] :(NSInteger)__LINE__ :[NSString stringWithFormat:@<span class="meta-string">"%s"</span>, __FUNCTION__]];</span></div></pre></td></tr></table></figure>
<p>整个日志系统，我已经开源放在了我的<a href="https://github.com/originalix/CuteLogger" target="_blank" rel="external">github</a>上，具体的代码可以去github上看。<br>欢迎提issue，如果有用，请点个star谢谢。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;好像很久没有写有关iOS的文章了，其实iOS的开发一直都是在进行的，但是最近有需求拓宽知识的宽度，所以一直在接触别的知识，当然啦，移动端开发并不能丢下。&lt;/p&gt;
&lt;p&gt;我平时开发的项目监测bug和崩溃的模块都是集成了鹅厂的&lt;code&gt;Bugly&lt;/code&gt;系统，毕竟是谁用谁说好的第三方系统。而&lt;code&gt;Bugly&lt;/code&gt;主要还是返回的还是崩溃之后的日志，所以如果想在平时的运行中，就能拿到客户手机中的日志怎么办呢。在这个需求的驱使下，便开始着手设计一个日志系统。&lt;/p&gt;
&lt;p&gt;需求还是不难的，记录手机操作的内容，如&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;时间|日志级别|类名_函数名_行数|分类|Log内容&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;这样的一种日志形式。&lt;/p&gt;
&lt;p&gt;因为不希望频繁的读写，所以希望每十条Log生成之后，读写一次。而未写入硬盘的Log保存在内存中。按照天数，每天都有一份日志，并且在客户的手机异常之后，可以将所有日志压缩上传到服务器。需求介绍完了，并不难对不对。&lt;/p&gt;
    
    </summary>
    
    
      <category term="iOS开发" scheme="http://yoursite.com/tags/iOS%E5%BC%80%E5%8F%91/"/>
    
      <category term="Cute-Logger" scheme="http://yoursite.com/tags/Cute-Logger/"/>
    
      <category term="日志系统" scheme="http://yoursite.com/tags/%E6%97%A5%E5%BF%97%E7%B3%BB%E7%BB%9F/"/>
    
  </entry>
  
  <entry>
    <title>Linux的用户管理(二)</title>
    <link href="http://yoursite.com/2017/06/21/Linux%E7%9A%84%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86(%E4%BA%8C)/"/>
    <id>http://yoursite.com/2017/06/21/Linux的用户管理(二)/</id>
    <published>2017-06-21T09:45:39.000Z</published>
    <updated>2017-06-21T09:47:23.000Z</updated>
    
    <content type="html"><![CDATA[<p>上次的博客我们讲了关于Linux的用户管理的内容，现在我们来讲第二部分——系统用户组的管理。</p>
<p>每个用户都有一个用户组，系统可以对一个用户组中的所有用户进行集中管理。不同Linux系统对用户组的规定有所不同，如Linux下的用户属于它同名的用户组，这个用户组在创建用户的同时创建。</p>
<p>用户组的管理涉及用户组的添加、删除和修改。组的增加、删除和修改实际上就是对<code>/etc/group</code>文件的更新。</p>
<h3 id="增加用户组"><a href="#增加用户组" class="headerlink" title="增加用户组"></a>增加用户组</h3><p>添加一个新的用户组，使用<code>groupadd</code>命令。 格式如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">groupadd [options] [group]</div><div class="line"></div><div class="line">可以使用的选项有： </div><div class="line">-g GID 指定新用户组的组标识号（GID）。</div><div class="line">-o 一般与-g选项同时使用，表示新用户组的GID可以与系统已有用户组的GID相同。</div></pre></td></tr></table></figure>
<a id="more"></a>
<p>举个🌰：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">groupadd group1</div><div class="line"></div><div class="line">此命令向系统中增加了一个新组group1，新组的组标识号是在当前已有的最大组标识号的基础上加1。 </div><div class="line"></div><div class="line">groupadd -g 101 group2</div><div class="line"></div><div class="line">此命令向系统中增加了一个新组group2，同时指定新组的组标识号是101。</div></pre></td></tr></table></figure>
<h3 id="删除用户组"><a href="#删除用户组" class="headerlink" title="删除用户组"></a>删除用户组</h3><p>如果要删除一个存在的用户组，使用<code>groupdel</code>命令,格式如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">groupdel [用户组]</div></pre></td></tr></table></figure>
<p>举个🌰：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"># groupdel group1</div><div class="line"></div><div class="line">此命令从系统中删除组group1</div></pre></td></tr></table></figure>
<h3 id="修改用户组属性"><a href="#修改用户组属性" class="headerlink" title="修改用户组属性"></a>修改用户组属性</h3><p>修改用户组的属性使用<code>groupmod</code>命令。其语法如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">groupmod 选项 用户组</div><div class="line"></div><div class="line">常用的选项有： </div><div class="line"></div><div class="line">-g GID 为用户组指定新的组标识号。</div><div class="line"></div><div class="line">-o 与-g选项同时使用，用户组的新GID可以与系统已有用户组的GID相同。</div><div class="line"></div><div class="line">-n新用户组 将用户组的名字改为新名字</div></pre></td></tr></table></figure>
<p>举个🌰:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"># groupmod -g 102 group2</div><div class="line"></div><div class="line">此命令将组group2的组标识号修改为102。 </div><div class="line"></div><div class="line">groupmod –g 10000 -n group3 group2</div><div class="line"></div><div class="line">此命令将组group2的标识号改为10000，组名修改为group3</div></pre></td></tr></table></figure>
<h3 id="切换用户组"><a href="#切换用户组" class="headerlink" title="切换用户组"></a>切换用户组</h3><p>如果一个用户同时属于多个用户组，那么用户可以在用户组之间切换，以便具有其他用户组的权限。用户可以在登录后，使用命令<code>newgrp</code>切换到其他用户组，这个命令的参数就是目的用户组。例如： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ newgrp root</div></pre></td></tr></table></figure>
<p>这条命令将当前用户切换到root用户组，前提条件是root用户组确实是该用户的主组或附加组。类似于用户账号的管理，用户组的管理也可以通过集成的系统管理工具来完成。</p>
<h3 id="账号相关的系统文件"><a href="#账号相关的系统文件" class="headerlink" title="账号相关的系统文件"></a>账号相关的系统文件</h3><p>完成用户管理的工作有许多种方法，但是每一种方法实际上都是对有关的系统文件进行修改。与用户和用户组相关的信息都存放在一些系统文件中，这些文件包括<code>/etc/passwd</code>, <code>/etc/shadow</code>, <code>/etc/group</code>等。下面分别介绍这些文件的内容。</p>
<p><code>/etc/passwd</code>文件是用户管理工作涉及的最重要的一个文件。Linux系统中的每个用户都在<code>/etc/passwd</code>文件中有一个对应的记录行，它记录了这个用户的一些基本属性。这个文件对所有用户都是可读的。它的内容类似下面的例子： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">　　＃ cat /etc/passwd</div><div class="line">　　</div><div class="line"></div><div class="line">　　root:x:0:0:Superuser:/:</div><div class="line"></div><div class="line">　　daemon:x:1:1:System daemons:/etc:</div><div class="line"></div><div class="line">　　bin:x:2:2:Owner of system commands:/bin:</div><div class="line"></div><div class="line">　　sys:x:3:3:Owner of system files:/usr/sys:</div><div class="line"></div><div class="line">　　adm:x:4:4:System accounting:/usr/adm:</div><div class="line"></div><div class="line">　　uucp:x:5:5:UUCP administrator:/usr/lib/uucp:</div><div class="line"></div><div class="line">　　auth:x:7:21:Authentication administrator:/tcb/files/auth:</div><div class="line"></div><div class="line">　　cron:x:9:16:Cron daemon:/usr/spool/cron:</div><div class="line"></div><div class="line">　　listen:x:37:4:Network daemon:/usr/net/nls:</div><div class="line"></div><div class="line">　　lp:x:71:18:Printer administrator:/usr/spool/lp:</div><div class="line"></div><div class="line">　　sam:x:200:50:Sam san:/usr/sam:/bin/sh</div></pre></td></tr></table></figure>
<p>从上面的例子我们可以看到，/etc/passwd中一行记录对应着一个用户，每行记录又被冒号(:)分隔为7个字段，其格式和具体含义如下： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">用户名:口令:用户标识号:组标识号:注释性描述:主目录:登录Shell</div></pre></td></tr></table></figure>
<ul>
<li><p>“用户名”是代表用户账号的字符串。通常长度不超过8个字符，并且由大小写字母和/或数字组成。登录名中不能有冒号(:)，因为冒号在这里是分隔符。为了兼容起见，登录名中最好不要包含点字符(.)，并且不使用连字符(-)和加号(+)打头。 </p>
</li>
<li><p>“口令”一些系统中，存放着加密后的用户口令字。。虽然这个字段存放的只是用户口令的加密串，不是明文，但是由于/etc/passwd文件对所有用户都可读，所以这仍是一个安全隐患。因此，现在许多Linux 系统（如SVR4）都使用了shadow技术，把真正的加密后的用户口令字存放到/etc/shadow文件中，而在/etc/passwd文件的口令字段中只存放一个特殊的字符，例如“x”或者“*”。 </p>
</li>
<li><p>“用户标识号”是一个整数，系统内部用它来标识用户。一般情况下它与用户名是一一对应的。如果几个用户名对应的用户标识号是一样的，系统内部将把它们视为同一个用户，但是它们可以有不同的口令、不同的主目录以及不同的登录Shell等。 </p>
</li>
</ul>
<p>通常用户标识号的取值范围是0～65 535。0是超级用户root的标识号，1～99由系统保留，作为管理账号，普通用户的标识号从100开始。在Linux系统中，这个界限是500。 </p>
<ul>
<li><p>“组标识号”字段记录的是用户所属的用户组。它对应着/etc/group文件中的一条记录。 </p>
</li>
<li><p>“注释性描述”字段记录着用户的一些个人情况，例如用户的真实姓名、电话、地址等，这个字段并没有什么实际的用途。在不同的Linux 系统中，这个字段的格式并没有统一。在许多Linux系统中，这个字段存放的是一段任意的注释性描述文字，用做finger命令的输出。 </p>
</li>
<li><p>“主目录”，也就是用户的起始工作目录，它是用户在登录到系统之后所处的目录。在大多数系统中，各用户的主目录都被组织在同一个特定的目录下，而用户主目录的名称就是该用户的登录名。各用户对自己的主目录有读、写、执行（搜索）权限，其他用户对此目录的访问权限则根据具体情况设置。 
　</p>
</li>
<li>用户登录后，要启动一个进程，负责将用户的操作传给内核，这个进程是用户登录到系统后运行的命令解释器或某个特定的程序，即Shell。Shell是用户与Linux系统之间的接口。Linux的Shell有许多种，每种都有不同的特点。常用的有sh(Bourne Shell), csh(C Shell), ksh(Korn Shell), tcsh(TENEX/TOPS-20 type C Shell), bash(Bourne Again Shell)等。系统管理员可以根据系统情况和用户习惯为用户指定某个Shell。如果不指定Shell，那么系统使用sh为默认的登录Shell，即这个字段的值为/bin/sh。 </li>
</ul>
<p>用户的登录Shell也可以指定为某个特定的程序（此程序不是一个命令解释器）。利用这一特点，我们可以限制用户只能运行指定的应用程序，在该应用程序运行结束后，用户就自动退出了系统。有些Linux 系统要求只有那些在系统中登记了的程序才能出现在这个字段中。 </p>
<p>用户组的所有信息都存放在/etc/group文件中。 </p>
<p>将用户分组是Linux 系统中对用户进行管理及控制访问权限的一种手段。每个用户都属于某个用户组；一个组中可以有多个用户，一个用户也可以属于不同的组。当一个用户同时是多个组中的成员时，在/etc/passwd文件中记录的是用户所属的主组，也就是登录时所属的默认组，而其他组称为附加组。用户要访问属于附加组的文件时，必须首先使用newgrp命令使自己成为所要访问的组中的成员。用户组的所有信息都存放在/etc/group文件中。此文件的格式也类似于/etc/passwd文件，由冒号(:)隔开若干个字段，这些字段有： </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">组名:口令:组标识号:组内用户列表</div></pre></td></tr></table></figure>
<ul>
<li>“组名”是用户组的名称，由字母或数字构成。与/etc/passwd中的登录名一样，组名不应重复。 </li>
<li><p>“口令”字段存放的是用户组加密后的口令字。一般Linux 系统的用户组都没有口令，即这个字段一般为空，或者是*。 </p>
</li>
<li><p>“组标识号”与用户标识号类似，也是一个整数，被系统内部用来标识组。 </p>
</li>
<li><p>“组内用户列表”是属于这个组的所有用户的列表/b]，不同用户之间用逗号(,)分隔。这个用户组可能是用户的主组，也可能是附加组。 </p>
</li>
</ul>
<p>举个🌰:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">　　/etc/group文件的一个例子如下： </div><div class="line"></div><div class="line">　　# cat /etc/group </div><div class="line"></div><div class="line">　　root::0:root</div><div class="line"></div><div class="line">　　bin::2:root,bin</div><div class="line"></div><div class="line">　　sys::3:root,uucp</div><div class="line"></div><div class="line">　　adm::4:root,adm</div><div class="line"></div><div class="line">　　daemon::5:root,daemon</div><div class="line"></div><div class="line">　　lp::7:root,lp</div><div class="line"></div><div class="line">　　users::20:root,sam</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;上次的博客我们讲了关于Linux的用户管理的内容，现在我们来讲第二部分——系统用户组的管理。&lt;/p&gt;
&lt;p&gt;每个用户都有一个用户组，系统可以对一个用户组中的所有用户进行集中管理。不同Linux系统对用户组的规定有所不同，如Linux下的用户属于它同名的用户组，这个用户组在创建用户的同时创建。&lt;/p&gt;
&lt;p&gt;用户组的管理涉及用户组的添加、删除和修改。组的增加、删除和修改实际上就是对&lt;code&gt;/etc/group&lt;/code&gt;文件的更新。&lt;/p&gt;
&lt;h3 id=&quot;增加用户组&quot;&gt;&lt;a href=&quot;#增加用户组&quot; class=&quot;headerlink&quot; title=&quot;增加用户组&quot;&gt;&lt;/a&gt;增加用户组&lt;/h3&gt;&lt;p&gt;添加一个新的用户组，使用&lt;code&gt;groupadd&lt;/code&gt;命令。 格式如下&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;groupadd [options] [group]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;可以使用的选项有： &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-g GID 指定新用户组的组标识号（GID）。&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;-o 一般与-g选项同时使用，表示新用户组的GID可以与系统已有用户组的GID相同。&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
      <category term="Linux" scheme="http://yoursite.com/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>Linux的用户管理(一)</title>
    <link href="http://yoursite.com/2017/06/12/Linux%E7%9A%84%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86(%E4%B8%80)/"/>
    <id>http://yoursite.com/2017/06/12/Linux的用户管理(一)/</id>
    <published>2017-06-12T08:25:53.000Z</published>
    <updated>2017-06-12T12:27:58.000Z</updated>
    
    <content type="html"><![CDATA[<p>在看《鸟哥的Linux私房菜》的第四章之前，我操作Linux系统时，习惯性的使用<code>root</code>账号，为什么呢？无非图一个方便，没有那么多权限设置，对当时我这个<code>Linux</code>小白来说，再好不过了。但是看完了鸟哥的书，我才意识到当时的操作是有多大的问题，所以在此书写一下以便日后回顾。</p>
<p><code>Linux</code>系统是一个多用户多任务的分时操作系统，任何一个要使用系统资源的用户，都必须首先向系统管理员申请一个账号，然后以这个账号的身份进入系统。用户的账号一方面可以帮助系统管理员对使用系统的用户进行跟踪，并控制他们对系统资源的访问；另一方面也可以帮助用户组织文件，并为用户提供安全性保护。每个用户账号都拥有一个惟一的用户名和各自的口令。用户在登录时键入正确的用户名和口令后，就能够进入系统和自己的主目录。</p>
<a id="more"></a>
<p>实现用户账号的管理，要完成的工作主要有如下几个方面：</p>
<pre><code>- 用户账号的添加、删除与修改。
- 用户口令的管理。
- 用户组的管理。  
</code></pre><h2 id="Linux系统用户账号的管理"><a href="#Linux系统用户账号的管理" class="headerlink" title="Linux系统用户账号的管理"></a>Linux系统用户账号的管理</h2><p>用户账号的管理工作主要涉及到用户账号的添加、修改和删除。</p>
<p>添加用户账号就是在系统中创建一个新账号，然后为新账号分配用户号、用户组、主目录和登录Shell等资源。刚添加的账号是被锁定的，无法使用。  </p>
<h3 id="添加账号"><a href="#添加账号" class="headerlink" title="添加账号"></a>添加账号</h3><p><strong> 添加新的用户账号使用useradd命令，其语法如下：  </strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">useradd 选项 用户名</div><div class="line"></div><div class="line"></div><div class="line">其中各选项含义如下：</div><div class="line"></div><div class="line">-c comment 指定一段注释性描述。</div><div class="line"></div><div class="line"><span class="_">-d</span> 目录 指定用户主目录，如果此目录不存在，则同时使用-m选项，可以创建主目录。</div><div class="line"></div><div class="line">-g 用户组 指定用户所属的用户组。</div><div class="line"></div><div class="line">-G 用户组，用户组 指定用户所属的附加组。</div><div class="line"></div><div class="line"><span class="_">-s</span> Shell文件 指定用户的登录Shell。</div><div class="line"></div><div class="line">-u 用户号 指定用户的用户号，如果同时有-o选项，则可以重复使用其他用户的标识号。</div><div class="line"></div><div class="line">用户名 指定新账号的登录名。</div></pre></td></tr></table></figure>
<p>举个🌰子</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># useradd –d /usr/lix -m lix</div><div class="line"></div><div class="line">此命令创建了一个用户lix，</div><div class="line">其中-d和-m选项用来为登录名lix产生一个主目录/usr/lix（/usr为默认的用户主目录所在的父目录）。</div></pre></td></tr></table></figure>
<h3 id="删除账号"><a href="#删除账号" class="headerlink" title="删除账号"></a>删除账号</h3><p>如果一个用户的账号不再使用，可以从系统中删除。删除用户账号就是要将/etc/passwd等系统文件中的该用户记录删除，必要时还删除用户的主目录。删除一个已有的用户账号使用userdel命令，其格式如下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">userdel 选项 用户名</div><div class="line"></div><div class="line">常用的选项是-r，它的作用是把用户的主目录一起删除。</div></pre></td></tr></table></figure>
<p>例如：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># userdel lix</span></div></pre></td></tr></table></figure>
<p>此命令删除用户sam在系统文件中（主要是/etc/passwd, /etc/shadow, /etc/group等）的记录，同时删除用户的主目录。</p>
<h3 id="修改账号"><a href="#修改账号" class="headerlink" title="修改账号"></a>修改账号</h3><p>修改用户账号就是根据实际情况更改用户的有关属性，如用户号、主目录、用户组、登录Shell等。</p>
<p>修改已有用户的信息使用usermod命令，其格式如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">usermod 选项 用户名</div><div class="line"></div><div class="line"></div><div class="line">常用的选项包括-c, <span class="_">-d</span>, -m, -g, -G, <span class="_">-s</span>, -u以及-o等，这些选项的意义与useradd命令中的选项一样，可以为用户指定新的资源值。另外，有些系统可以使用如下选项：</div><div class="line"></div><div class="line">　　</div><div class="line"> <span class="_">-l</span> 新用户名</div><div class="line"></div><div class="line"></div><div class="line">这个选项指定一个新的账号，即将原来的用户名改为新的用户名。</div></pre></td></tr></table></figure>
<p>🌰子：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">usermod <span class="_">-s</span> /bin/ksh <span class="_">-d</span> /home/z –g developer lix</div></pre></td></tr></table></figure>
<p>此命令将用户lix的登录Shell修改为ksh，主目录改为/home/z，用户组改为developer。</p>
<h3 id="用户口令管理"><a href="#用户口令管理" class="headerlink" title="用户口令管理"></a>用户口令管理</h3><p>用户管理的一项重要内容是用户口令的管理。用户账号刚创建时没有口令，但是被系统锁定，无法使用，必须为其指定口令后才可以使用，即使是指定空口令。</p>
<p>　　指定和修改用户口令的Shell命令是<code>passwd</code>。超级用户可以为自己和其他用户指定口令，普通用户只能用它修改自己的口令。命令的格式为：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">passwd 选项 用户名</div><div class="line"></div><div class="line"></div><div class="line">可使用的选项：</div><div class="line"></div><div class="line"><span class="_">-l</span> 锁定口令，即禁用账号。</div><div class="line"></div><div class="line">-u 口令解锁。</div><div class="line"></div><div class="line"><span class="_">-d</span> 使账号无口令。</div><div class="line"></div><div class="line"><span class="_">-f</span> 强迫用户下次登录时修改口令。</div><div class="line"></div><div class="line">如果默认用户名，则修改当前用户的口令。</div></pre></td></tr></table></figure>
<p>例如，假设当前用户是lix，则下面的命令修改该用户自己的口令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">　　$ passwd</div><div class="line"></div><div class="line">　　Old password:******</div><div class="line"></div><div class="line">　　New password:*******</div><div class="line"></div><div class="line">　　Re-enter new password:*******</div></pre></td></tr></table></figure>
<p>如果是超级用户，可以用下列形式指定任何用户的口令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">　　# passwd lix</div><div class="line"></div><div class="line">　　New password:*******</div><div class="line"></div><div class="line">　　Re-enter new password:*******</div></pre></td></tr></table></figure>
<p>普通用户修改自己的口令时，passwd命令会先询问原口令，验证后再要求用户输入两遍新口令，如果两次输入的口令一致，则将这个口令指定给用户；而超级用户为用户指定口令时，就不需要知道原口令。  </p>
<p>为了系统安全起见，用户应该选择比较复杂的口令，例如最好使用8位长的口令，口令中包含有大写、小写字母和数字，并且应该与姓名、生日等不相同。</p>
<p>为用户指定空口令时，执行下列形式的命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">passwd -d lix</div></pre></td></tr></table></figure>
<p>此命令将用户lix的口令删除，这样用户lix下一次登录时，系统就不再询问口令。</p>
<p>passwd命令还可以用-l(lock)选项锁定某一用户，使其不能登录，例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">passwd -l lix</div></pre></td></tr></table></figure>
<p>关于用户操作账户操作的 今天先讲到这里，用户组的操作下章接着记录。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;在看《鸟哥的Linux私房菜》的第四章之前，我操作Linux系统时，习惯性的使用&lt;code&gt;root&lt;/code&gt;账号，为什么呢？无非图一个方便，没有那么多权限设置，对当时我这个&lt;code&gt;Linux&lt;/code&gt;小白来说，再好不过了。但是看完了鸟哥的书，我才意识到当时的操作是有多大的问题，所以在此书写一下以便日后回顾。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Linux&lt;/code&gt;系统是一个多用户多任务的分时操作系统，任何一个要使用系统资源的用户，都必须首先向系统管理员申请一个账号，然后以这个账号的身份进入系统。用户的账号一方面可以帮助系统管理员对使用系统的用户进行跟踪，并控制他们对系统资源的访问；另一方面也可以帮助用户组织文件，并为用户提供安全性保护。每个用户账号都拥有一个惟一的用户名和各自的口令。用户在登录时键入正确的用户名和口令后，就能够进入系统和自己的主目录。&lt;/p&gt;
    
    </summary>
    
    
      <category term="Linux" scheme="http://yoursite.com/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>Liunx的文件权限</title>
    <link href="http://yoursite.com/2017/06/02/Liunx%E7%9A%84%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90/"/>
    <id>http://yoursite.com/2017/06/02/Liunx的文件权限/</id>
    <published>2017-06-02T02:37:39.000Z</published>
    <updated>2017-06-02T02:39:37.000Z</updated>
    
    <content type="html"><![CDATA[<p>之前讲过为了统一开发环境生产环境以及更换开发机器的情况，我把环境统一由<code>Vagrant</code>部署在<code>Linux</code>的虚拟机中，但是由于我对<code>Linux</code>系统没有系统的学习过，对于环境的部署也仅仅通过谷歌等刚刚入门，所以在具体的开发中我还是经常在<code>Linux</code>中遇到问题，经常求教老大。看着老大熟练的把玩<code>Linux</code>，我也下定决心要把<code>Linux</code>掌握好。</p>
<p>经自己了解，《鸟哥的Linux私房菜》一书备受推崇，于是于半个月前购入，开始拜读学习。在日常的工作时间之外，断断续续的学习着，确实受益匪浅，厚厚的一本书现在才看了四分之一左右，决定还是抽出时间记录一下自己曾经对于<code>Linux</code>感到困惑的一些事情。</p>
<p>今天就来说说<code>Linux</code>中文件权限的一些门门道道。</p>
<a id="more"></a>
<p>当初我在部署第一个<code>Laravel</code>项目到阿里云的时候，在部署完成后，看到教程中要给<code>storage</code>文件设置权限，当时这个777 775等这种数字简直把我弄迷糊了。只能对照着命令乖乖的敲进去，神奇的是敲进去之后，果然问题解决了，站点能访问了。感觉甚是困惑。看完书中的文件权限一章之后，才发觉<code>Linux</code>中文件权限的神奇。</p>
<p>查看文件权限的语句：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 在终端输入:</span></div><div class="line">ls <span class="_">-l</span> xxx.xxx （xxx.xxx是文件名）</div><div class="line"><span class="comment"># 那么就会出现相类似的信息，主要都是这些：</span></div><div class="line">-rw-rw-r--</div></pre></td></tr></table></figure>
<p>一共有10位数</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">其中： 最前面那个 - 代表的是类型</div><div class="line">中间那三个 rw- 代表的是所有者（user）</div><div class="line">然后那三个 rw- 代表的是组群（group）</div><div class="line">最后那三个 r-- 代表的是其他人（other）</div><div class="line">然后我再解释一下后面那9位数：</div><div class="line">r 表示文件可以被读（<span class="built_in">read</span>）</div><div class="line">w 表示文件可以被写（write）</div><div class="line">x 表示文件可以被执行（如果它是程序的话）</div><div class="line">- 表示相应的权限还没有被授予</div><div class="line"></div><div class="line">现在该说说修改文件权限了</div><div class="line">在终端输入：</div><div class="line">chmod o w xxx.xxx</div><div class="line">表示给其他人授予写xxx.xxx这个文件的权限</div><div class="line">chmod go-rw xxx.xxx</div><div class="line">表示删除xxx.xxx中组群和其他人的读和写的权限</div></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">其中：</div><div class="line">　　u 代表所有者（user）</div><div class="line">　　g 代表所有者所在的组群（group）</div><div class="line">　　o 代表其他人，但不是u和g （other）</div><div class="line">　　a 代表全部的人，也就是包括u，g和o</div><div class="line">　　r 表示文件可以被读（<span class="built_in">read</span>）</div><div class="line">　　w 表示文件可以被写（write）</div><div class="line">　　x 表示文件可以被执行（如果它是程序的话）</div><div class="line">　　其中：rwx也可以用数字来代替</div><div class="line">　　r ------------4</div><div class="line">　　w -----------2</div><div class="line">　　x ------------1</div><div class="line">　　- ------------0</div></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">行动：</div><div class="line">　　 表示添加权限</div><div class="line">　　- 表示删除权限</div><div class="line">　　= 表示使之成为唯一的权限</div><div class="line">　　当大家都明白了上面的东西之后，那么我们常见的以下的一些权限就很容易都明白了：</div><div class="line">　　-rw------- (600) 只有所有者才有读和写的权限</div><div class="line">　　-rw-r--r-- (644) 只有所有者才有读和写的权限，组群和其他人只有读的权限</div><div class="line">　　-rwx------ (700) 只有所有者才有读，写，执行的权限</div><div class="line">　　-rwxr-xr-x (755) 只有所有者才有读，写，执行的权限，组群和其他人只有读和执行的权限</div><div class="line">　　-rwx--x--x (711) 只有所有者才有读，写，执行的权限，组群和其他人只有执行的权限</div><div class="line">　　-rw-rw-rw- (666) 每个人都有读写的权限</div><div class="line">　　-rwxrwxrwx (777) 每个人都有读写和执行的权限</div></pre></td></tr></table></figure>
<p>常用的权限修改命令:</p>
<ul>
<li>chgrp ：改变文件所属群组</li>
<li>chown ：改变文件拥有者</li>
<li>chmod ：改变文件的权限, SUID, SGID, SBIT等等的特性</li>
</ul>
<p>改变权限, chmod</p>
<p>文件权限的改变使用的是chmod这个指令，但是，权限的设定方法有两种， 分别可以使用数字或者是符号来进行权限的变更。我们就来谈一谈：</p>
<p>数字类型改变文件权限</p>
<p>各权限的分数对照表如下：<br>r:4<br>w:2<br>x:1<br>每种身份(owner/group/others)各自的三个权限(r/w/x)分数是需要累加的，例如当权限为： [-rwxrwx—] 分数则是：<br>owner = rwx = 4+2+1 = 7<br>group = rwx = 4+2+1 = 7<br>others= — = 0+0+0 = 0</p>
<p>在讲解清楚了这种权限分值的累加之后，再去体会自己当初敲入命令行中的数字，是不是恍然大悟了呢。不知道你们是不是，反正我是这样的。今天小小的知识点就记录到这里，下次有时间再更新咯。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;之前讲过为了统一开发环境生产环境以及更换开发机器的情况，我把环境统一由&lt;code&gt;Vagrant&lt;/code&gt;部署在&lt;code&gt;Linux&lt;/code&gt;的虚拟机中，但是由于我对&lt;code&gt;Linux&lt;/code&gt;系统没有系统的学习过，对于环境的部署也仅仅通过谷歌等刚刚入门，所以在具体的开发中我还是经常在&lt;code&gt;Linux&lt;/code&gt;中遇到问题，经常求教老大。看着老大熟练的把玩&lt;code&gt;Linux&lt;/code&gt;，我也下定决心要把&lt;code&gt;Linux&lt;/code&gt;掌握好。&lt;/p&gt;
&lt;p&gt;经自己了解，《鸟哥的Linux私房菜》一书备受推崇，于是于半个月前购入，开始拜读学习。在日常的工作时间之外，断断续续的学习着，确实受益匪浅，厚厚的一本书现在才看了四分之一左右，决定还是抽出时间记录一下自己曾经对于&lt;code&gt;Linux&lt;/code&gt;感到困惑的一些事情。&lt;/p&gt;
&lt;p&gt;今天就来说说&lt;code&gt;Linux&lt;/code&gt;中文件权限的一些门门道道。&lt;/p&gt;
    
    </summary>
    
    
      <category term="Linux" scheme="http://yoursite.com/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>使用Vagrant来搭建开发环境</title>
    <link href="http://yoursite.com/2017/05/15/%E4%BD%BF%E7%94%A8Vagrant%E6%9D%A5%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/"/>
    <id>http://yoursite.com/2017/05/15/使用Vagrant来搭建开发环境/</id>
    <published>2017-05-15T08:36:31.000Z</published>
    <updated>2017-05-15T08:37:21.000Z</updated>
    
    <content type="html"><![CDATA[<p>在大半年前刚刚接触PHP的时候，因为那时候只想先熟悉PHP的语法，并且对配置服务器、Mysql等一干事情不想花费太多时间，于是在网上找到了XAMPP这个解决方案。当时那是惊为天人，感觉虚拟主机很是方便。但是随着后来自己的慢慢深入，并且也在云服务器上陆续的部署自己的小项目，这才感觉到一个很恶心的事情，就是本地和线上的开发环境不同意，导致自己在频繁的修改配置文件，并且主力开发机器是用mac，家里还有win10的台式机，线上是Liunx系统，各种不一样的环境让我想寻求一个解决方案，统一线上和线下的开发环境。</p>
<p>在这种想法的指引下，很快有一个解决方案进入我的视线。通过搭建Liunx虚拟机，解决线上线下开发环境不统一的情况。这个解决方案，就是<code>VirtualBox</code> + <code>Vagrant</code>。目前他能完成我的所有需求，并且提供了很快捷的打包，来实现开发环境的迁移及统一部署，非常好用。本文就来记录如何使用Vagrant这个工具，好让我在日后部署环境的时候，能够把这些命令翻出来再看看。</p>
<a id="more"></a>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><blockquote>
<p>实际上Vagrant只是一个让你可以方便设置你想要的虚拟机的便携式工具，它底层支持VirtualBox、VMware甚至AWS作为虚拟机系统，本书中我们将使用VirtualBox来进行说明，所以第一步需要先安裝Vagrant和VirtualBox。</p>
</blockquote>
<p>安装环境：mac<br>注：windows环境下，基本一致</p>
<h3 id="安装VirtualBox"><a href="#安装VirtualBox" class="headerlink" title="安装VirtualBox"></a>安装VirtualBox</h3><p>直接来到官网 <a href="https://www.virtualbox.org/wiki/Downloads" target="_blank" rel="external">https://www.virtualbox.org/wiki/Downloads</a> 点击下载最新的virtualbox，双击安装，一路傻瓜化完成。</p>
<h3 id="安装Vagrant"><a href="#安装Vagrant" class="headerlink" title="安装Vagrant"></a>安装Vagrant</h3><p>在进行完上一个步骤后，我们就要考虑我们的虚拟机需要使用什么操作系统了。因为我线上使用了<code>Ubuntu16.04</code>的操作系统，所以我线下也选择了16.04的<code>Ubuntu</code>操作系统。在以前使用vm的过程中，我们需要自己去下载镜像，然后进行相关的安装，设置系统等等操作。而vagrant的开源社区，提供了很多已经打包好的操作系统，在vagrant的世界里被称为box。在 <a href="http://www.vagrantbox.es/" target="_blank" rel="external">http://www.vagrantbox.es/</a> 这里你可以找到你想要的操作系统box，当然你也可以自己制作一个。后续教程会讲到，这里就不多说。</p>
<p>我的开发机是Mac，所以我建立了如下的开发环境目录：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ /Users/vagrant</div><div class="line">$ cd /Users/vagrant</div></pre></td></tr></table></figure>
<p>这里注意，vagrant提供的在线安装，有可能因为天朝的网络原因，很慢或者下载失败，所以我会找到box的下载链接，用迅雷等工具下载好这个盒子。之后执行安装设置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ vagrant box add &#123;title&#125; &#123;url&#125;</div><div class="line">$ vagrant init &#123;title&#125;</div><div class="line">$ vagrant up</div></pre></td></tr></table></figure>
<p><code>vagrant box add</code> 是添加box的命令<br>其中｛title｝可以自行设置，我这里使用的是 <code>Ubuntu</code> ，｛url｝是下载到本地box路径。我的路径是：/Users/vagrant/ubuntu.box</p>
<p>box中的镜像文件被放到了：/Users/.vagrant.d/boxes/，如果在window系统中应该是放到了： C:\Users\当前用户名.vagrant.d\boxes\目录下。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"># 如果是才add 的box，就必须执行本步骤，初始化一次后，以后启动系统，就不需要执行本步骤。</div><div class="line">$ vagrant init Ubuntu</div></pre></td></tr></table></figure>
<p>输出如下 : </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">A `Vagrantfile` has been placed in this directory.</div><div class="line">You are now ready to `vagrant up` your first virtual environment!</div><div class="line">Please read the comments in the Vagrantfile as well as documentation on `vagrantup.com` for more information on using Vagrant.</div></pre></td></tr></table></figure>
<p>这样就会在当前目录生成一个 Vagrantfile的文件，里面有很多配置信息，后面我在慢慢说，默认不做任何配置改动，也是可以启动系统的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># 启动系统</div><div class="line">$ vagrant up</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Bringing machine &apos;default&apos; up with &apos;virtualbox&apos; provider...</div><div class="line">[default] Importing base box &apos;base&apos;...</div><div class="line">[default] Matching MAC address for NAT networking...</div><div class="line">[default] Setting the name of the VM...</div><div class="line">[default] Clearing any previously set forwarded ports...</div><div class="line">...</div></pre></td></tr></table></figure>
<h2 id="ssh链接到虚拟机"><a href="#ssh链接到虚拟机" class="headerlink" title="ssh链接到虚拟机"></a>ssh链接到虚拟机</h2><p>经过以上操作后，完成了虚拟机的安装，现在需要登录上虚拟机，进行操作。链接很简单，可以使用第三方（xshell等）shell工具或系统自带的，进行登录<br>在系统中，如mac，可直接使用 vagrant ssh 来完成链接。或者使用第三方如xshell，ip地址是：localhost，端口，需要观察，映射的22端口是多少。一般是2200 或者2222<br>用户名与密码均是： vagrant</p>
<h2 id="vagrant的命令详解"><a href="#vagrant的命令详解" class="headerlink" title="vagrant的命令详解"></a>vagrant的命令详解</h2><table>
<thead>
<tr>
<th>命令</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>vagrant box add</td>
<td>添加box的操作</td>
</tr>
<tr>
<td>vagrant init</td>
<td>初始化box的操作，会生成vagrant的配置文件Vagrantfile</td>
</tr>
<tr>
<td>vagrant up</td>
<td>启动本地环境</td>
</tr>
<tr>
<td>vagrant ssh</td>
<td>通过 ssh 登录本地环境所在虚拟机</td>
</tr>
<tr>
<td>vagrant halt</td>
<td>关闭本地环境</td>
</tr>
<tr>
<td>vagrant suspend</td>
<td>暂停本地环境</td>
</tr>
<tr>
<td>vagrant resume</td>
<td>恢复本地环境</td>
</tr>
<tr>
<td>vagrant reload</td>
<td>修改了 Vagrantfile 后，使之生效（相当于先 halt，再 up）</td>
</tr>
<tr>
<td>vagrant destroy</td>
<td>彻底移除本地环境</td>
</tr>
<tr>
<td>vagrant box list</td>
<td>显示当前已经添加的box列表</td>
</tr>
<tr>
<td>vagrant box remove</td>
<td>删除相应的box</td>
</tr>
<tr>
<td>vagrant package</td>
<td>打包命令，可以把当前的运行的虚拟机环境进行打包</td>
</tr>
<tr>
<td>vagrant plugin</td>
<td>用于安装卸载插件</td>
</tr>
<tr>
<td>vagrant status</td>
<td>获取当前虚拟机的状态</td>
</tr>
<tr>
<td>vagrant global-status</td>
<td>显示当前用户Vagrant的所有环境状态</td>
</tr>
</tbody>
</table>
<h2 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h2><p>配置好Vagrant只是开始，而之后在Linux配置环境，可以参考我之前的一篇文章，在《云服务器上部署Laravel》这篇文章，来配置自己的<code>LNMP</code>环境。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;在大半年前刚刚接触PHP的时候，因为那时候只想先熟悉PHP的语法，并且对配置服务器、Mysql等一干事情不想花费太多时间，于是在网上找到了XAMPP这个解决方案。当时那是惊为天人，感觉虚拟主机很是方便。但是随着后来自己的慢慢深入，并且也在云服务器上陆续的部署自己的小项目，这才感觉到一个很恶心的事情，就是本地和线上的开发环境不同意，导致自己在频繁的修改配置文件，并且主力开发机器是用mac，家里还有win10的台式机，线上是Liunx系统，各种不一样的环境让我想寻求一个解决方案，统一线上和线下的开发环境。&lt;/p&gt;
&lt;p&gt;在这种想法的指引下，很快有一个解决方案进入我的视线。通过搭建Liunx虚拟机，解决线上线下开发环境不统一的情况。这个解决方案，就是&lt;code&gt;VirtualBox&lt;/code&gt; + &lt;code&gt;Vagrant&lt;/code&gt;。目前他能完成我的所有需求，并且提供了很快捷的打包，来实现开发环境的迁移及统一部署，非常好用。本文就来记录如何使用Vagrant这个工具，好让我在日后部署环境的时候，能够把这些命令翻出来再看看。&lt;/p&gt;
    
    </summary>
    
    
      <category term="Linux" scheme="http://yoursite.com/tags/Linux/"/>
    
      <category term="Vagrant" scheme="http://yoursite.com/tags/Vagrant/"/>
    
  </entry>
  
  <entry>
    <title>nginx配置二级域名</title>
    <link href="http://yoursite.com/2017/05/05/nginx%E9%85%8D%E7%BD%AE%E4%BA%8C%E7%BA%A7%E5%9F%9F%E5%90%8D/"/>
    <id>http://yoursite.com/2017/05/05/nginx配置二级域名/</id>
    <published>2017-05-05T09:23:29.000Z</published>
    <updated>2017-05-15T08:41:11.000Z</updated>
    
    <content type="html"><![CDATA[<p>最近为了练手Vue框架，写了一个博客项目，昨天刚刚把个人博客部署上线，因为前后端分离，所以使用Ajax来请求后端api接口获取数据，部署的过程中碰到了一个坑。我只有一个域名，所以想让一级域名<code>originalix.com</code>来访问博客，而使用二级域名<code>demo.originalix.com</code>来访问后端页面并且请求api。</p>
<p>怎么做呢，在查阅了资料以后发现，首先应该在域名供应商中添加一条二级域名的记录，比如我想使用的是<strong>demo</strong>。</p>
<p><img src="http://originalix.github.io/assets/img/nginxdomain.png" alt=""></p>
<p>设置好域名后，在本地<strong>ping</strong>一下看看能不能<strong>ping</strong>通过 <code>demo.originalix.com</code></p>
<a id="more"></a>
<p>接下来，ssh进服务器，找到你安装的nginx，启动并且配置。</p>
<ul>
<li>安装nginx</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install nginx</div></pre></td></tr></table></figure>
<ul>
<li>重启nginx</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo service nginx start</div></pre></td></tr></table></figure>
<ul>
<li>进入nginx配置文件</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo vim /etc/nginx/sites-available/default</div></pre></td></tr></table></figure>
<p>在配置文件中可以这样写</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">server &#123;  </div><div class="line">    listen 80;</div><div class="line">    server_name originalix.com;</div><div class="line"></div><div class="line">    location / &#123;</div><div class="line">        proxy_set_header   X-Real-IP $remote_addr;</div><div class="line">        proxy_set_header   Host      $http_host;</div><div class="line">        proxy_pass         http://127.0.0.1:2368;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">server &#123;  </div><div class="line">    listen 80;</div><div class="line">    server_name demo.originalix.com;</div><div class="line"></div><div class="line">    location / &#123;</div><div class="line">        proxy_set_header   X-Real-IP $remote_addr;</div><div class="line">        proxy_set_header   Host      $http_host;</div><div class="line">        proxy_pass         http://127.0.0.1:8000;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>而我具体是因为后端是<code>Laravel</code>框架的项目，所以我得配置文件是这样写的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line">server &#123;</div><div class="line">    listen 80 default_server;</div><div class="line">    listen [::]:80 default_server;</div><div class="line"></div><div class="line">    root /var/www/;</div><div class="line"></div><div class="line">    index index.html index.htm index.nginx-debian.html;</div><div class="line"></div><div class="line">    # server_name 110.223.38.82;</div><div class="line">    server_name http://originalix.xyz;</div><div class="line"></div><div class="line">    location / &#123;</div><div class="line">            try_files $uri $uri/ /index.php?$query_string;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    location ~ \.php$ &#123;</div><div class="line">            try_files $uri /index.php =404;</div><div class="line">            fastcgi_split_path_info ^(.+\.php)(/.+)$;</div><div class="line">            fastcgi_pass unix:/run/php/php7.0-fpm.sock;</div><div class="line">            fastcgi_index index.php;</div><div class="line">            fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;</div><div class="line">            include fastcgi_params;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">server &#123;</div><div class="line">    listen 80;</div><div class="line">    server_name demo.originalix.com;</div><div class="line">    root /var/www/originalix/public;</div><div class="line">    index index.php index.html index.htm;</div><div class="line">    location / &#123;</div><div class="line">        try_files $uri $uri/ /index.php?$query_string;</div><div class="line">    &#125;</div><div class="line">    location ~ \.php$ &#123;</div><div class="line">      try_files $uri /index.php =404;</div><div class="line">      fastcgi_split_path_info ^(.+\.php)(/.+)$;</div><div class="line">      fastcgi_pass unix:/run/php/php7.0-fpm.sock;</div><div class="line">      fastcgi_index index.php;</div><div class="line">      fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;</div><div class="line">      include fastcgi_params;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>之后重启nginx，并且打开浏览器，输入 <code>demo.originalix.com</code> 就ok了</p>
<p>ps:在整个过程中如果遇到什么问题，比如 nginx启动失败。可以看一下这里：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">//这个命令可以看一下你的nginx配置文件有没有问题，</div><div class="line">//如果有问题它会指出，做相应的修改，直到没报错</div><div class="line">nginx -t </div><div class="line"></div><div class="line"></div><div class="line">//查看日志。比如我nginx -t明明没问题，老是启动失败，</div><div class="line">//看了日志才知道 Address already in use，端口被占用o(╯□╰)o</div><div class="line">cat /var/log/nginx/error.log</div></pre></td></tr></table></figure>
<p>还是那句话，失败了一定要学会看日志！！！看日志！！！看日志！！！</p>
<p>很简单的事情，我也是摸索了一会儿，崩溃ing。</p>
<p>所以写个博客记录下来，希望能帮助到大家。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;最近为了练手Vue框架，写了一个博客项目，昨天刚刚把个人博客部署上线，因为前后端分离，所以使用Ajax来请求后端api接口获取数据，部署的过程中碰到了一个坑。我只有一个域名，所以想让一级域名&lt;code&gt;originalix.com&lt;/code&gt;来访问博客，而使用二级域名&lt;code&gt;demo.originalix.com&lt;/code&gt;来访问后端页面并且请求api。&lt;/p&gt;
&lt;p&gt;怎么做呢，在查阅了资料以后发现，首先应该在域名供应商中添加一条二级域名的记录，比如我想使用的是&lt;strong&gt;demo&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://originalix.github.io/assets/img/nginxdomain.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;设置好域名后，在本地&lt;strong&gt;ping&lt;/strong&gt;一下看看能不能&lt;strong&gt;ping&lt;/strong&gt;通过 &lt;code&gt;demo.originalix.com&lt;/code&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="Linux" scheme="http://yoursite.com/tags/Linux/"/>
    
      <category term="nginx" scheme="http://yoursite.com/tags/nginx/"/>
    
      <category term="Domin" scheme="http://yoursite.com/tags/Domin/"/>
    
  </entry>
  
  <entry>
    <title>简单的编程体会</title>
    <link href="http://yoursite.com/2017/04/26/%E7%AE%80%E5%8D%95%E7%9A%84%E7%BC%96%E7%A8%8B%E4%BD%93%E4%BC%9A/"/>
    <id>http://yoursite.com/2017/04/26/简单的编程体会/</id>
    <published>2017-04-26T09:09:52.000Z</published>
    <updated>2017-04-26T09:10:57.000Z</updated>
    
    <content type="html"><![CDATA[<p>今天的这篇博文，我不谈及具体的编程技术，只想从这段时间的学习以及写代码的过程中，分享一下自己的编程体会。</p>
<a id="more"></a>
<p>上周呢，项目中碰到了一个新的任务，要接入一个第三方外设厂商的蓝牙设备，对方公司提供了一个sdk。其实接入一个sdk这个小事情呢，每个从业者都会碰到，合理的选用第三方的sdk服务能大大缩短我们的开发时间，让我们把目光都放到自己的核心业务上去。而碰巧这个sdk是对方公司新写出来的，于是，本着怀疑的态度，我开始了对这个sdk包的接入工作。</p>
<p>由于这个sdk包是新版，为了预防后面的升级，为了松耦合，我在这个第三方库上加了一层完整的封装。仔细的整理好项目的需求，封装了一层适用于项目的API接口，并且提供给团队的小伙伴使用。而既然是要提供给团队的小伙伴使用的API，我在编写代码的过程中慎之又慎，单元测试覆盖率基本达到了95%以上。很早以前我有一篇博文，是专门讲TDD模式和一款Kiwi的测试框架，其实那个阶段的我，更多的是停留在对那款单元测试的框架使用和摸索上，并没有极大程度的重视TDD的思想。而在又重读《Clean Code》这本书之后，单元测试的这根弦又在我脑子里绷紧了。</p>
<p>于是在这次的编码过程中，没有经过单元测试的代码，坚决不能放在生产环境里成了我坚持的原则，每一行代码都必须跑过，在各种条件下测试过，才会成为放心的代码，才能在之后放心的重构。不然小伙伴调用API的时候如果产生了一堆bug，你让我这张脸往哪搁。在这样的实践之下，我逐渐尝到了测试驱动开发这个思想的甜头，之前我还有接入其他设备的经验，但是当时赶工期，缺乏系统的单元测试，使得上线后bug不断，有时候debug时定位都要花费一些功夫，但是当你的每行代码都跑过单元测试时，你会对你的代码很有信心，并且能梳理的逻辑更清楚。况且，你要进行单元测试，那么以最小单元模块为单位的代码块或者函数，也必然是一段短小的代码，符合短函数的要求，最近苛刻的要求自己绝对不写超过20行的代码。只为函数的单一职责和逻辑清晰。</p>
<p>通过近期补充自己的数据结构和算法知识，我在敲代码的过程中，对这个方面，也多了一层考虑。从一些细节方面来思考怎么把代码写的更好，除了表层的代码风格，在组织数据时，考虑是否有合适的数据结构类型可以使用，并且哪怕小到一个排序算法，或者查找算法，也会想怎么写才能更有效率，平衡时间复杂度和空间复杂度的关系。这些意识都是之前所不具备的，所以感觉到最近自己在编程方面通过学习还是有一些提升的。而同时也很后悔自己对于这方面知识的学习来的太晚，回顾以前写的代码，还是生产了不小量的脏代码。检索一组规律数据，使用从头遍历这样时间复杂度底下的方式，实在不应该。</p>
<p>其他的一些编码细节也慢慢注意了起来，比如命名的更合理规范明确，比如函数在类里的摆放位置，一切其实都是为了一个事情，就是代码的可读性。写出来的代码20%的时间在开发，80%的时间在维护，可读性是非常重要的一件事情，而最近不断培养的也正是这个意识，只希望写出能让人读的舒服的代码。仅此而已。</p>
<p>近期敲得代码比较杂，写过前端三件套，HTML+CSS+JavaScript,并且系统的学习了Vue框架，也用了stylus这个css预处理器写过css，算法数据结构用Java写，后端的处理是php，框架使用了Laravel，iOS端Swift Objective-C混写，慢慢的有种感受就是，其实用什么框架用什么语言真的无所谓，早先时候，自己还是太过于追求框架，有时候学习的路线反而是不正确是，是要去深刻的理解一门语言，以及这个语言主要解决问题的场景，而非如何使用一个趁手的框架去完成任务，轮子是永远造不完的，旧的框架以后一定会被新的取代，而语言特性这种小细节，是需要去细细体会，花时间琢磨的。</p>
<p>今天随便说说的一些体会，也只是为了写出更好的代码，仅此而已。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;今天的这篇博文，我不谈及具体的编程技术，只想从这段时间的学习以及写代码的过程中，分享一下自己的编程体会。&lt;/p&gt;
    
    </summary>
    
    
      <category term="编程体会" scheme="http://yoursite.com/tags/%E7%BC%96%E7%A8%8B%E4%BD%93%E4%BC%9A/"/>
    
  </entry>
  
  <entry>
    <title>最大子列和问题</title>
    <link href="http://yoursite.com/2017/04/22/%E6%9C%80%E5%A4%A7%E5%AD%90%E5%88%97%E5%92%8C%E9%97%AE%E9%A2%98/"/>
    <id>http://yoursite.com/2017/04/22/最大子列和问题/</id>
    <published>2017-04-22T09:39:12.000Z</published>
    <updated>2017-04-22T09:41:02.000Z</updated>
    
    <content type="html"><![CDATA[<p>今天来讨论一个很基础的算法问题，数列的最大子列和问题。这道题我是在看浙大陈姥姥的Mooc的时候看到的，算是陈越老师作为算法与数据结构开篇讲解的第一道算法实例题。</p>
<p>那么今天我就来记录一下分析这道题的过程。</p>
<h2 id="常用方法"><a href="#常用方法" class="headerlink" title="常用方法"></a>常用方法</h2><p>首先，最大子列和这个问题有一个众所周知的办法，即为每次从数列的开头i，往结尾N累加，当加至结尾时，由i+1再次累加，直到N-N。这样的算法用三个变量三层循环来分别代表从头至尾的遍历，以及从i - N的前进继续累加，最后一层是累加的和。算法可以写成下面这样：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">MaxSubseqSum1</span><span class="params">(<span class="keyword">int</span>[] A, <span class="keyword">int</span> N)</span> </span>&#123;</div><div class="line">       <span class="keyword">int</span> ThisSum, MaxSum = <span class="number">0</span>;</div><div class="line">       <span class="keyword">int</span> i, j, k;</div><div class="line">       <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; N; i++) &#123;</div><div class="line">           <span class="keyword">for</span> (j = i; j &lt; N; j++) &#123;</div><div class="line">               ThisSum = <span class="number">0</span>;</div><div class="line">               <span class="keyword">for</span> (k = i; k &lt;= j; k++) &#123;</div><div class="line">                   ThisSum += A[k];</div><div class="line">               &#125;</div><div class="line">               <span class="keyword">if</span> (ThisSum &gt; MaxSum) &#123;</div><div class="line">                   MaxSum = ThisSum;</div><div class="line">               &#125;</div><div class="line">           &#125;</div><div class="line">       &#125;</div><div class="line">       <span class="keyword">return</span> MaxSum;</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<a id="more"></a>
<p>上面的第一种方法应该非常好理解，而由于是三层循环，所以，这个算法的时间复杂度是T(N) = O(N^3)。这种时间复杂度的算法，是非常的低效的，并且我们作为一个有追求的程序员，看到一个时间复杂度上有平方以上指数的，必须要考虑的是降次。</p>
<p>那么其实，第一种算法，如果我们仔细思考，那么可以发现它最里面的一层，k循环是一个很愚蠢的行为，因为我们可以直接在第二层循环里完成累加，于是，我们可以写一个稍微简单的算法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">MaxSubseqSum2</span><span class="params">(<span class="keyword">int</span>[] A, <span class="keyword">int</span> N)</span> </span>&#123;</div><div class="line">       <span class="keyword">int</span> ThisSum;</div><div class="line">       <span class="keyword">int</span> MaxSum = <span class="number">0</span>;</div><div class="line">       <span class="keyword">int</span> i, j;</div><div class="line">       <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; N; i++) &#123;</div><div class="line">           ThisSum = <span class="number">0</span>;</div><div class="line">           <span class="keyword">for</span> (j = i; j &lt; N; j++) &#123;</div><div class="line">               ThisSum += A[j];</div><div class="line">               <span class="keyword">if</span> (ThisSum &gt; MaxSum) &#123;</div><div class="line">                   MaxSum = ThisSum;</div><div class="line">               &#125;</div><div class="line">           &#125;</div><div class="line">       &#125;</div><div class="line">       <span class="keyword">return</span> MaxSum;</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<p>而这个去了一个循环的算法，时间复杂度也一目了然，T(N) = O(N^2),但是时间复杂度依旧还有2次方。接下来还有什么更好的办法么？</p>
<h2 id="分治法"><a href="#分治法" class="headerlink" title="分治法"></a>分治法</h2><p>在这里我们介绍一种方法叫分治法，分而治之。这个方法的思想是，先把数列切割成左右两个部分，接下来，递归的把数列不断切割为两份，直到最小单位为一个元素。而这时，分别去求他们的子列和，并且在求算左半边和右半边的子列和之后，把跨越二分边界的子列和也求解出来。比较左半边的最大子列和，以及右半边的最大子列和，以及跨越边界的最大子列和。取出最大的那个数，即为整个数列的最大子列和。</p>
<p>这是一种很常用的算法思想，可以先看代码来理解一下。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">    * 分治法，保持API一致</div><div class="line">    * <span class="doctag">@param</span> A 求解数列</div><div class="line">    * <span class="doctag">@param</span> N 元素总数</div><div class="line">    * <span class="doctag">@return</span></div><div class="line">    */</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">MaxSubseqSum3</span><span class="params">(<span class="keyword">int</span>[] A, <span class="keyword">int</span> N)</span> </span>&#123;</div><div class="line">       <span class="keyword">return</span> DivideAndConquer(A, <span class="number">0</span>, N-<span class="number">1</span>);</div><div class="line">   &#125;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line">    * 分治法主体</div><div class="line">    * <span class="doctag">@param</span> List 求解数列</div><div class="line">    * <span class="doctag">@param</span> left 左半边的下标</div><div class="line">    * <span class="doctag">@param</span> right 右半边的下标</div><div class="line">    * <span class="doctag">@return</span> 所求数列的最大子列和</div><div class="line">    */	</div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">DivideAndConquer</span><span class="params">(<span class="keyword">int</span>[] List, <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</div><div class="line">       <span class="keyword">int</span> MaxLeftSum, MaxRightSum;</div><div class="line">       <span class="keyword">int</span> MaxLeftBorderSum, MaxRightBorderSum;</div><div class="line">       <span class="keyword">int</span> LeftBorderSum, RightBorderSum;</div><div class="line">       <span class="keyword">int</span> center, i;</div><div class="line"></div><div class="line">       <span class="keyword">if</span> (left == right) &#123;</div><div class="line">           <span class="keyword">if</span> (List[left] &gt; <span class="number">0</span>) &#123;</div><div class="line">               <span class="keyword">return</span> List[left];</div><div class="line">           &#125; <span class="keyword">else</span> &#123;</div><div class="line">               <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">           &#125;</div><div class="line">       &#125;</div><div class="line"></div><div class="line">       center = (left + right) / <span class="number">2</span>;</div><div class="line">       </div><div class="line">	<span class="comment">//分解数列 不断递归调用</span></div><div class="line">       MaxLeftSum = DivideAndConquer(List, left, center);</div><div class="line">       MaxRightSum = DivideAndConquer(List, center + <span class="number">1</span>, right);</div><div class="line">	</div><div class="line">	<span class="comment">//分别结算左右两边的跨越边界的和</span></div><div class="line">       MaxLeftBorderSum = <span class="number">0</span>; LeftBorderSum = <span class="number">0</span>;</div><div class="line">       <span class="keyword">for</span> (i = center; i &gt;= left; i--) &#123;</div><div class="line">           LeftBorderSum += List[i];</div><div class="line">           <span class="keyword">if</span> (LeftBorderSum &gt; MaxLeftBorderSum) &#123;</div><div class="line">               MaxLeftBorderSum = LeftBorderSum;</div><div class="line">           &#125;</div><div class="line">       &#125;</div><div class="line"></div><div class="line">       MaxRightBorderSum = <span class="number">0</span>; RightBorderSum = <span class="number">0</span>;</div><div class="line">       <span class="keyword">for</span> (i = center + <span class="number">1</span>; i &lt;= right; i++) &#123;</div><div class="line">           RightBorderSum += List[i];</div><div class="line">           <span class="keyword">if</span> (RightBorderSum &gt; MaxLeftBorderSum) &#123;</div><div class="line">               MaxRightBorderSum = RightBorderSum;</div><div class="line">           &#125;</div><div class="line">       &#125;</div><div class="line">       <span class="keyword">return</span> Max3(MaxLeftSum, MaxRightSum, MaxLeftBorderSum + MaxRightBorderSum);</div><div class="line">   &#125;</div><div class="line">   </div><div class="line"> <span class="comment">/**</span></div><div class="line">    * 取三个数中的最大值</div><div class="line">    * <span class="doctag">@return</span> int</div><div class="line">    */</div><div class="line">   <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">Max3</span><span class="params">(<span class="keyword">int</span> A, <span class="keyword">int</span> B, <span class="keyword">int</span> C)</span> </span>&#123;</div><div class="line">       <span class="keyword">return</span> A &gt; B ? A &gt; C ? A : C : B &gt; C ? B : C;</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<p>而分治法的时间复杂度，是</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">T(1) = O(1)</div><div class="line">T (N) = 2T(N/2) + cN</div><div class="line">= 2 [2T( N/22 ) + cN/2] + cN</div><div class="line">= 2kO(1) + ckN </div><div class="line">= O(NlogN )</div></pre></td></tr></table></figure>
<p>现在我们可以看到，这个问题我们已经完成我们的降次目标了。那么还有更好的算法么？</p>
<h2 id="在线处理"><a href="#在线处理" class="headerlink" title="在线处理"></a>在线处理</h2><p>这个问题有个最简单的算法，叫在线处理法，遍历数列的时候，顺便累加，每次累加的和若是小于0，那么我们可以认为最大子列和为负数时，一定不会让后面的部分增大了，所以就可以把它丢弃，重新置当前的<code>sum = 0</code>。</p>
<p>代码如下:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">MaxSubseqSum4</span><span class="params">(<span class="keyword">int</span>[] A, <span class="keyword">int</span> N)</span> </span>&#123;</div><div class="line">       <span class="keyword">int</span> ThisSum, MaxSum;</div><div class="line">       <span class="keyword">int</span> i;</div><div class="line">       ThisSum = MaxSum = <span class="number">0</span>;</div><div class="line">       <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; N; i++) &#123;</div><div class="line">           ThisSum += A[i];</div><div class="line">           <span class="keyword">if</span> (ThisSum &gt; MaxSum) &#123;</div><div class="line">               MaxSum = ThisSum;</div><div class="line">           &#125; <span class="keyword">else</span> <span class="keyword">if</span> (ThisSum &lt; <span class="number">0</span>) &#123;</div><div class="line">               ThisSum = <span class="number">0</span>;</div><div class="line">           &#125;</div><div class="line">       &#125;</div><div class="line">       <span class="keyword">return</span> MaxSum;</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<p>在线处理的时间复杂度，因为是只遍历一遍，所以为T(N) = O(N)。<br>那么说了这么多，我们需要让事实来说话，我们现在准备一个30个元素的队列，让每个算法跑100000次来观察所需时间。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> size = <span class="number">31</span>;</div><div class="line">    <span class="keyword">int</span>[] testArr = &#123;<span class="number">3</span>, -<span class="number">1</span>, <span class="number">5</span>, <span class="number">10</span>, -<span class="number">8</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">7</span>, -<span class="number">5</span>, -<span class="number">6</span>, <span class="number">3</span>, -<span class="number">8</span>, -<span class="number">10</span>,</div><div class="line">            <span class="number">10</span>, -<span class="number">20</span>, -<span class="number">8</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>, -<span class="number">9</span>, -<span class="number">10</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">0</span>, -<span class="number">8</span>, <span class="number">10</span>, -<span class="number">4</span>, <span class="number">10</span>, -<span class="number">7</span>&#125;;</div><div class="line">    <span class="keyword">int</span> runCount = <span class="number">100000</span>;</div><div class="line">    testFunction1(testArr, size, runCount);</div><div class="line">    testFunction2(testArr, size, runCount);</div><div class="line">    testFunction3(testArr, size, runCount);</div><div class="line">    testFunction4(testArr, size, runCount);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>最后的log输出是这样的:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Max Subsequence Sum <span class="number">1</span> is <span class="number">23</span></div><div class="line">function1 run time is  <span class="number">738</span>ms</div><div class="line">Max Subsequence Sum <span class="number">2</span> is <span class="number">23</span></div><div class="line">function2 run time is  <span class="number">44</span>ms</div><div class="line">Max Subsequence Sum <span class="number">3</span> is <span class="number">17</span></div><div class="line">function3 run time is  <span class="number">110</span>ms</div><div class="line">Max Subsequence Sum <span class="number">4</span> is <span class="number">17</span></div><div class="line">function4 run time is  <span class="number">54</span>ms</div></pre></td></tr></table></figure>
<p>上面的function的标号，对应上面的4种方法，可以看到，如果我们真的用了第一种笨办法，那么他和高效算法之间的效率差距，实在是太大了。</p>
<p>算法的学习还要继续，多看书，多做题。那么我们下次再分享了。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;今天来讨论一个很基础的算法问题，数列的最大子列和问题。这道题我是在看浙大陈姥姥的Mooc的时候看到的，算是陈越老师作为算法与数据结构开篇讲解的第一道算法实例题。&lt;/p&gt;
&lt;p&gt;那么今天我就来记录一下分析这道题的过程。&lt;/p&gt;
&lt;h2 id=&quot;常用方法&quot;&gt;&lt;a href=&quot;#常用方法&quot; class=&quot;headerlink&quot; title=&quot;常用方法&quot;&gt;&lt;/a&gt;常用方法&lt;/h2&gt;&lt;p&gt;首先，最大子列和这个问题有一个众所周知的办法，即为每次从数列的开头i，往结尾N累加，当加至结尾时，由i+1再次累加，直到N-N。这样的算法用三个变量三层循环来分别代表从头至尾的遍历，以及从i - N的前进继续累加，最后一层是累加的和。算法可以写成下面这样：&lt;/p&gt;
&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;MaxSubseqSum1&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;[] A, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; N)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;       &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; ThisSum, MaxSum = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;       &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i, j, k;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;       &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; N; i++) &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;           &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (j = i; j &amp;lt; N; j++) &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;               ThisSum = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;               &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (k = i; k &amp;lt;= j; k++) &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                   ThisSum += A[k];&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;               &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;               &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (ThisSum &amp;gt; MaxSum) &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;                   MaxSum = ThisSum;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;               &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;           &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;       &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;       &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; MaxSum;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;   &amp;#125;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
      <category term="Algorithm" scheme="http://yoursite.com/tags/Algorithm/"/>
    
  </entry>
  
  <entry>
    <title>牛顿迭代法与二分法计算平方根</title>
    <link href="http://yoursite.com/2017/04/11/%E7%89%9B%E9%A1%BF%E8%BF%AD%E4%BB%A3%E6%B3%95%E4%B8%8E%E4%BA%8C%E5%88%86%E6%B3%95%E8%AE%A1%E7%AE%97%E5%B9%B3%E6%96%B9%E6%A0%B9/"/>
    <id>http://yoursite.com/2017/04/11/牛顿迭代法与二分法计算平方根/</id>
    <published>2017-04-11T08:37:33.000Z</published>
    <updated>2017-04-11T08:39:14.000Z</updated>
    
    <content type="html"><![CDATA[<p>因为不是科班出身，所以即使编程一段时间也时常感觉自身基础知识非常不扎实，于是在最近开始补习算法和计算机理论的基础知识。</p>
<p>目前看的算法书籍是《算法》（第四版），由<strong>Robert Sedgewick</strong>以及<strong>Kevin Wayne</strong>编写的，由于不可能把所有的练习都写成博客记录下来，于是就在学习过程中，挑选一些有意思的写成笔记，以便日后参考以及与同行互相交流。</p>
<p>今天要准备写的就是非常经典的牛顿迭代法求平方根，事实上现在的绝大部分编程语言中，标准库中都已经为我们准备好了计算平方根的函数，但是本着学习的精神，今天我们也要写出一个求平方根的函数。</p>
<a id="more"></a>
<p>牛顿法是一种在实数域和复数域上近似求解方程的方法。方法使用函数 <strong>f(x)</strong>的泰勒级数的前面几项来寻找方程<strong>f(x)=0</strong>的根。首先我们先来看函数图像。<br><img src="http://img.blog.csdn.net/20151223235920481" alt=""></p>
<p>首先，选择一个接近函数<strong>f(x)</strong>零点的<strong>x0</strong>,计算相应的<strong>f(x0)</strong>和切线斜率<strong>f’(x0)</strong>（这里<strong>f’</strong>表示函数<strong>f</strong>的导数)。<br>也就是求如下方程的解：</p>
<p><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/547ee85ecabac97a25778a6e336f6b3325ac07d1" alt=""></p>
<p>我们将新求得的点 x坐标命名为x1，通常x1会比x0更接近方程f(x)=0的解。因此我们现在可以利用x1开始下一轮迭代。迭代公式可化简为如下所示：</p>
<p><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/6929060731e351c465426e37567abe5ee13d65d9" alt=""></p>
<p>而求平方根的方程我们可以看成<strong>f(x) = x^2 - a</strong>,a即为我们要求平方根的常数。</p>
<p>于是在算法代码的编写上，我们也可以用这种猜的思想，来近似求解这个平方根，我们需要定义一个精度，若<strong>Xn+1-Xn</strong>的值小于我们的精度值，那么我们即可以认为Xn为我们要求的解。</p>
<p>所以算法代码编写如下(采用Java示例)。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * 牛顿迭代法求平方根</div><div class="line"> * <span class="doctag">@param</span>  number   求值的数</div><div class="line"> * <span class="doctag">@param</span>  accuracy 精度</div><div class="line"> * <span class="doctag">@return</span>          Double</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">double</span> <span class="title">NewtonSqrt</span><span class="params">(<span class="keyword">double</span> number, <span class="keyword">double</span> accuracy)</span> </span>&#123;</div><div class="line">		 <span class="comment">//第一个猜测值</span></div><div class="line">        <span class="keyword">double</span> guess = number / <span class="number">2</span>;</div><div class="line">        <span class="keyword">int</span> count = <span class="number">0</span>;</div><div class="line">        <span class="keyword">if</span> (number &lt; <span class="number">0</span>) &#123;</div><div class="line">            <span class="keyword">return</span> Double.NaN;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">//当两个猜测的差值大于精度即return</span></div><div class="line">        <span class="keyword">while</span> (Math.abs(guess - (number / guess)) &gt; accuracy) &#123;</div><div class="line">        	<span class="comment">//迭代公式推导而成</span></div><div class="line">            guess = (guess + (number / guess)) / <span class="number">2</span>;</div><div class="line">            count++;</div><div class="line">            System.out.printf(<span class="string">"try count = %d, guess = %f\n"</span>, count, guess);</div><div class="line">        &#125;</div><div class="line">        System.out.printf(<span class="string">"final result = %f\n"</span>, guess);</div><div class="line">        <span class="keyword">return</span> guess;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>牛顿迭代法求平方根的代码就如上面所示，而接下来为了体现牛顿迭代法的优势，我们再写一个二分法计算平方根的算法，来对比：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">double</span> <span class="title">DichotomySqrt</span><span class="params">(<span class="keyword">double</span> number, <span class="keyword">double</span> accuracy)</span> </span>&#123;</div><div class="line">    <span class="keyword">double</span> higher = number;</div><div class="line">    <span class="keyword">double</span> lower = <span class="number">0.0</span>;</div><div class="line">    <span class="keyword">double</span> middle = (lower + higher) / <span class="number">2</span>;</div><div class="line">    <span class="keyword">double</span> last_middle = <span class="number">0.00</span>;</div><div class="line">    <span class="keyword">int</span> count = <span class="number">0</span>;</div><div class="line">    <span class="keyword">if</span> (number &lt; <span class="number">0</span>) &#123;</div><div class="line">        <span class="keyword">return</span> Double.NaN;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">while</span> (Math.abs(middle - last_middle) &gt; accuracy) &#123;</div><div class="line">        <span class="keyword">if</span> (middle * middle &gt; number) &#123;</div><div class="line">            higher = middle;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            lower = middle;</div><div class="line">        &#125;</div><div class="line">        last_middle = middle;</div><div class="line">        middle = (lower + higher) / <span class="number">2</span>;</div><div class="line">        count++;</div><div class="line">        System.out.printf(<span class="string">"Dichotomy try count = %d, guess = %f\n"</span>, count, last_middle);</div><div class="line">    &#125;</div><div class="line">    System.out.printf(<span class="string">"Dichotomy final result = %f\n"</span>, last_middle);</div><div class="line">    <span class="keyword">return</span> last_middle;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>二分法的讲解就不多说了，跟牛顿迭代法的验证结果相似，看精度差是否在定义范围内。</p>
<p>那么接下来我们来测试二分法和牛顿迭代法求值的效率。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">    <span class="keyword">double</span> result = NewtonSqrt(<span class="number">2</span>,<span class="number">1e-3</span>);</div><div class="line">    <span class="keyword">double</span> dichotomyRes = DichotomySqrt(<span class="number">2</span>,<span class="number">1e-3</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>先看小精度情况下，求2的平方根</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">try</span> count = <span class="number">1</span> guess = <span class="number">1.5</span></div><div class="line"><span class="keyword">try</span> count = <span class="number">2</span> guess = <span class="number">1.4166666666666665</span></div><div class="line"><span class="keyword">try</span> count = <span class="number">3</span> guess = <span class="number">1.4142156862745097</span></div><div class="line"><span class="keyword">final</span> result = <span class="number">1.4142156862745097</span></div><div class="line"></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">1</span> guess = <span class="number">1.0</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">2</span> guess = <span class="number">1.5</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">3</span> guess = <span class="number">1.25</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">4</span> guess = <span class="number">1.375</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">5</span> guess = <span class="number">1.4375</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">6</span> guess = <span class="number">1.40625</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">7</span> guess = <span class="number">1.421875</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">8</span> guess = <span class="number">1.4140625</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">9</span> guess = <span class="number">1.41796875</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">10</span> guess = <span class="number">1.416015625</span></div><div class="line">Dichotomy <span class="keyword">final</span> result = <span class="number">1.416015625</span></div></pre></td></tr></table></figure>
<p>可以看到牛顿迭代法计算了3次，二分法计算了10次。</p>
<p>而精度稍大的时候</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">    <span class="keyword">double</span> result = NewtonSqrt(<span class="number">2</span>,<span class="number">1e-15</span>);</div><div class="line">    <span class="keyword">double</span> dichotomyRes = DichotomySqrt(<span class="number">2</span>,<span class="number">1e-15</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">try</span> count = <span class="number">1</span> guess = <span class="number">1.5</span></div><div class="line"><span class="keyword">try</span> count = <span class="number">2</span> guess = <span class="number">1.4166666666666665</span></div><div class="line"><span class="keyword">try</span> count = <span class="number">3</span> guess = <span class="number">1.4142156862745097</span></div><div class="line"><span class="keyword">try</span> count = <span class="number">4</span> guess = <span class="number">1.4142135623746899</span></div><div class="line"><span class="keyword">try</span> count = <span class="number">5</span> guess = <span class="number">1.414213562373095</span></div><div class="line"><span class="keyword">final</span> result = <span class="number">1.414213562373095</span></div><div class="line"></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">1</span> guess = <span class="number">1.0</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">2</span> guess = <span class="number">1.5</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">3</span> guess = <span class="number">1.25</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">4</span> guess = <span class="number">1.375</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">5</span> guess = <span class="number">1.4375</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">6</span> guess = <span class="number">1.40625</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">7</span> guess = <span class="number">1.421875</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">8</span> guess = <span class="number">1.4140625</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">9</span> guess = <span class="number">1.41796875</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">10</span> guess = <span class="number">1.416015625</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">11</span> guess = <span class="number">1.4150390625</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">12</span> guess = <span class="number">1.41455078125</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">13</span> guess = <span class="number">1.414306640625</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">14</span> guess = <span class="number">1.4141845703125</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">15</span> guess = <span class="number">1.41424560546875</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">16</span> guess = <span class="number">1.414215087890625</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">17</span> guess = <span class="number">1.4141998291015625</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">18</span> guess = <span class="number">1.4142074584960938</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">19</span> guess = <span class="number">1.4142112731933594</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">20</span> guess = <span class="number">1.4142131805419922</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">21</span> guess = <span class="number">1.4142141342163086</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">22</span> guess = <span class="number">1.4142136573791504</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">23</span> guess = <span class="number">1.4142134189605713</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">24</span> guess = <span class="number">1.4142135381698608</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">25</span> guess = <span class="number">1.4142135977745056</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">26</span> guess = <span class="number">1.4142135679721832</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">27</span> guess = <span class="number">1.414213553071022</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">28</span> guess = <span class="number">1.4142135605216026</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">29</span> guess = <span class="number">1.414213564246893</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">30</span> guess = <span class="number">1.4142135623842478</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">31</span> guess = <span class="number">1.4142135614529252</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">32</span> guess = <span class="number">1.4142135619185865</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">33</span> guess = <span class="number">1.4142135621514171</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">34</span> guess = <span class="number">1.4142135622678325</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">35</span> guess = <span class="number">1.4142135623260401</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">36</span> guess = <span class="number">1.414213562355144</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">37</span> guess = <span class="number">1.4142135623696959</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">38</span> guess = <span class="number">1.4142135623769718</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">39</span> guess = <span class="number">1.4142135623733338</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">40</span> guess = <span class="number">1.4142135623715149</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">41</span> guess = <span class="number">1.4142135623724243</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">42</span> guess = <span class="number">1.414213562372879</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">43</span> guess = <span class="number">1.4142135623731065</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">44</span> guess = <span class="number">1.4142135623729928</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">45</span> guess = <span class="number">1.4142135623730496</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">46</span> guess = <span class="number">1.414213562373078</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">47</span> guess = <span class="number">1.4142135623730923</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">48</span> guess = <span class="number">1.4142135623730994</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">49</span> guess = <span class="number">1.4142135623730958</span></div><div class="line">Dichotomy <span class="keyword">try</span> count = <span class="number">50</span> guess = <span class="number">1.414213562373094</span></div><div class="line">Dichotomy <span class="keyword">final</span> result = <span class="number">1.414213562373094</span></div></pre></td></tr></table></figure>
<p>这里就一目了然了，所以有时候，写代码一定不能想着功能实现了就好，在算法的效率上一定要多多思考。</p>
<p>不再举栗子了，免得有凑字数的嫌疑。下次再讨论咯。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;因为不是科班出身，所以即使编程一段时间也时常感觉自身基础知识非常不扎实，于是在最近开始补习算法和计算机理论的基础知识。&lt;/p&gt;
&lt;p&gt;目前看的算法书籍是《算法》（第四版），由&lt;strong&gt;Robert Sedgewick&lt;/strong&gt;以及&lt;strong&gt;Kevin Wayne&lt;/strong&gt;编写的，由于不可能把所有的练习都写成博客记录下来，于是就在学习过程中，挑选一些有意思的写成笔记，以便日后参考以及与同行互相交流。&lt;/p&gt;
&lt;p&gt;今天要准备写的就是非常经典的牛顿迭代法求平方根，事实上现在的绝大部分编程语言中，标准库中都已经为我们准备好了计算平方根的函数，但是本着学习的精神，今天我们也要写出一个求平方根的函数。&lt;/p&gt;
    
    </summary>
    
    
      <category term="算法" scheme="http://yoursite.com/tags/%E7%AE%97%E6%B3%95/"/>
    
      <category term="牛顿迭代法" scheme="http://yoursite.com/tags/%E7%89%9B%E9%A1%BF%E8%BF%AD%E4%BB%A3%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>《Clean Code》 读书小节（二）</title>
    <link href="http://yoursite.com/2017/04/02/%E3%80%8AClean-Code%E3%80%8B-%E8%AF%BB%E4%B9%A6%E5%B0%8F%E8%8A%82%EF%BC%88%E4%BA%8C%EF%BC%89/"/>
    <id>http://yoursite.com/2017/04/02/《Clean-Code》-读书小节（二）/</id>
    <published>2017-04-02T11:03:40.000Z</published>
    <updated>2017-04-02T11:06:25.000Z</updated>
    
    <content type="html"><![CDATA[<p>之前在看了《Clean Code》这本书的前两章时，就写下了第一篇读书小节，而随着读书的深入，便决定再总结一下后面一部分的读书心得。</p>
<h1 id="那些多余的注释"><a href="#那些多余的注释" class="headerlink" title="那些多余的注释"></a>那些多余的注释</h1><p>相信每一个程序员都经历过一个坑，那就是去阅读甚至修改没有注释的代码。如果这些代码风格糟糕，命名不遵循规则，毫无疑问这是一段你永远都不想回忆的时光，而若是这些代码命名准确，设计模式使用的恰到好处，函数拆分合理，说不定你有一种怎么读别人的代码比回顾我自己写的代码还清晰的错觉。</p>
<p>是的，毫无疑问我一直是代码是最好的注释这个说法的拥护者之一。但是，这里有个前提，就是你必须有能力写出优秀的代码，你才有资格去不写注释。我们要一直明白一个问题，我们的代码写出来是为了给别人看的，而不是仅仅给自己看的，如果你的团队有严谨的<strong>Code Review</strong>那你好意思写出脏乱不堪的代码被投影仪放到幕布上给所有部门同事看么？对于一个新手程序员来说，请老老实实的写好每一个关键函数的注释，也请在修改函数的时候，不吝时间的修改对应的注释。若是项目的目的是为了公开API给第三方开发者使用，那么请在开放api上写好注释，这是应该完善的工作。</p>
<p>而上述说的类型您都不是，那么我想该强调一下谈这个话题的主题了，去除那些多余的注释吧。有时候，在一些明显目的的函数上，加注释，会给阅读你代码的开发者一种错觉，你的水平很低，不足以理解代码，所以需要在简单的语句上加上注释。打个比方，你是我的面试官，有一道面试题，我在写完之后交给你，你看到的是如下格式的面试题：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">$arr = $User-&gt;where($where)-&gt;find(); <span class="comment">// 读取数据</span></div><div class="line"></div><div class="line">$list = [];</div><div class="line"><span class="keyword">foreach</span>($arr <span class="keyword">as</span> $key =&gt; $val) &#123; <span class="comment">// 遍历数组</span></div><div class="line">  $list[$key] = [</div><div class="line">    <span class="string">'name'</span> =&gt; $val[<span class="string">'name'</span>],</div><div class="line">    <span class="string">'age'</span> =&gt; $val[<span class="string">'age'</span>],</div><div class="line">  ];</div><div class="line">&#125;</div><div class="line"></div><div class="line">$list[<span class="string">'count'</span>] = count($arr); <span class="comment">// 其他属性</span></div><div class="line"></div><div class="line"><span class="keyword">echo</span> json_encode($list); <span class="comment">// 输出 json</span></div></pre></td></tr></table></figure>
<a id="more"></a>
<p>这是随手找的一个php的栗子，显而易见他不足以成为一道面试题，但是假设您今天就问我这道题，如何输出一串json格式的数据。我提交了这样一段代码给您看，那么您来体会下你看到这样一段代码的心情。不知道你会不会觉得我是认为您水平不够，才写这样的代码给你看，难道读取数据和遍历数组都需要写一个注释么？所以，请把那些自以为能让代码很易懂的注释去掉吧。大胆的去掉，假设你去了这些注释，我相信这段代码依然会一眼就明白它将执行什么任务。</p>
<p>其实最不应该随意加注释的原因是，我们往往勤于修改代码，而疏于及时变更注释。扪心自问一下，当有个紧急bug需要你修复的时候，你匆匆开电脑修改好了bug，会顺便把注释修改了么？所以，注释有时候是带有欺骗性质的，尤其是当版本迭代的越来越频繁的时候，注释的时效性就越来越差。往往会误导你理解代码。而永远不会欺骗你的，就是代码。</p>
<h1 id="格式"><a href="#格式" class="headerlink" title="格式"></a>格式</h1><p>今天的格式我们不去讨论变量名、函数名以及缩进大小写等等代码风格的范畴，我们就来讨论一个很小的点——函数摆放的位置。</p>
<p>在IDE越来越强大的今天，如果我们看到了函数里调用的方法，会怎么查看呢，直接按着Commond键就去查看了吧。其实很多程序员，在敲代码的大部分实际都在按着commond跳来跳去的看代码，而这时候，不起眼的函数的摆放位置就显得作用很大了。</p>
<p>函数的格式，应该是由上至下，从最顶层的代码，逐步的向最下层靠拢。被调用的代码都排在调用他的代码之下，这样在你看到主函数里有不清楚的函数时，眼睛向下扫一扫就知道下一个函数的大致了。而当你始终保持这样的排版，那么阅读你代码的程序员，应该是非常的享受的。</p>
<p>而我们定义的变量，亦是如此，变量的定义尽量靠近使用它的函数，而一些公共变量，请你始终保持放在同一个位置，可以是类的头部，也可以是尾部。</p>
<h1 id="净化数据结构"><a href="#净化数据结构" class="headerlink" title="净化数据结构"></a>净化数据结构</h1><p>在如今面向对象的思想下，大部分人都把东西想象成一个对象来处理，而这样的思想确实是被广为接受的，因为那样会让我们的代码更具有可读性以及践行某些设计模式，但是与之而来的就是我们该怎么处理对象内部的数据结构。有些不必让人了解的数据结构，我们应该充分的封装，做好读写属性的定义，在暴露的api中思考好命名和可读性。而继承、封装又是我们编程的必修课，在这里也就不再赘述，我还想讨论的一个现象，是暴露那些明确的数据结构，牺牲一些面向对象的思想，采取过程式编程来提高效率及可读性。举个例子：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">struct</span> <span class="title">CGPoint</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">var</span> x: <span class="type">CGFloat</span></div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">var</span> y: <span class="type">CGFloat</span></div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">init</span>()</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">init</span>(x: <span class="type">CGFloat</span>, y: <span class="type">CGFloat</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这是Swift对于<code>CGPoint</code>这个结构体的定义，我们平时在使用<code>CGPoint</code>的过程中，直接使用构造器方法创建一个CGPoint实例。而这里对于x,y这两个属性是直接暴露的。而这也是我们众所周知的平面坐标系，所以适当的暴露你的数据结构换取可读性也是可取的。</p>
<p>面向对象，和过程式编程本是一个冲突的思想，作为一个有思想的程序员，需要做出选择，目的是为了写出可读性更好的代码。</p>
<p>继续看书了，下次再聊，希望可以评论交流对于编码的思考。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;之前在看了《Clean Code》这本书的前两章时，就写下了第一篇读书小节，而随着读书的深入，便决定再总结一下后面一部分的读书心得。&lt;/p&gt;
&lt;h1 id=&quot;那些多余的注释&quot;&gt;&lt;a href=&quot;#那些多余的注释&quot; class=&quot;headerlink&quot; title=&quot;那些多余的注释&quot;&gt;&lt;/a&gt;那些多余的注释&lt;/h1&gt;&lt;p&gt;相信每一个程序员都经历过一个坑，那就是去阅读甚至修改没有注释的代码。如果这些代码风格糟糕，命名不遵循规则，毫无疑问这是一段你永远都不想回忆的时光，而若是这些代码命名准确，设计模式使用的恰到好处，函数拆分合理，说不定你有一种怎么读别人的代码比回顾我自己写的代码还清晰的错觉。&lt;/p&gt;
&lt;p&gt;是的，毫无疑问我一直是代码是最好的注释这个说法的拥护者之一。但是，这里有个前提，就是你必须有能力写出优秀的代码，你才有资格去不写注释。我们要一直明白一个问题，我们的代码写出来是为了给别人看的，而不是仅仅给自己看的，如果你的团队有严谨的&lt;strong&gt;Code Review&lt;/strong&gt;那你好意思写出脏乱不堪的代码被投影仪放到幕布上给所有部门同事看么？对于一个新手程序员来说，请老老实实的写好每一个关键函数的注释，也请在修改函数的时候，不吝时间的修改对应的注释。若是项目的目的是为了公开API给第三方开发者使用，那么请在开放api上写好注释，这是应该完善的工作。&lt;/p&gt;
&lt;p&gt;而上述说的类型您都不是，那么我想该强调一下谈这个话题的主题了，去除那些多余的注释吧。有时候，在一些明显目的的函数上，加注释，会给阅读你代码的开发者一种错觉，你的水平很低，不足以理解代码，所以需要在简单的语句上加上注释。打个比方，你是我的面试官，有一道面试题，我在写完之后交给你，你看到的是如下格式的面试题：&lt;/p&gt;
&lt;figure class=&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;$arr = $User-&amp;gt;where($where)-&amp;gt;find(); &lt;span class=&quot;comment&quot;&gt;// 读取数据&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;$list = [];&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;foreach&lt;/span&gt;($arr &lt;span class=&quot;keyword&quot;&gt;as&lt;/span&gt; $key =&amp;gt; $val) &amp;#123; &lt;span class=&quot;comment&quot;&gt;// 遍历数组&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  $list[$key] = [&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&#39;name&#39;&lt;/span&gt; =&amp;gt; $val[&lt;span class=&quot;string&quot;&gt;&#39;name&#39;&lt;/span&gt;],&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&#39;age&#39;&lt;/span&gt; =&amp;gt; $val[&lt;span class=&quot;string&quot;&gt;&#39;age&#39;&lt;/span&gt;],&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  ];&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;$list[&lt;span class=&quot;string&quot;&gt;&#39;count&#39;&lt;/span&gt;] = count($arr); &lt;span class=&quot;comment&quot;&gt;// 其他属性&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;echo&lt;/span&gt; json_encode($list); &lt;span class=&quot;comment&quot;&gt;// 输出 json&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
      <category term="编码思考" scheme="http://yoursite.com/tags/%E7%BC%96%E7%A0%81%E6%80%9D%E8%80%83/"/>
    
      <category term="代码风格" scheme="http://yoursite.com/tags/%E4%BB%A3%E7%A0%81%E9%A3%8E%E6%A0%BC/"/>
    
      <category term="clean code" scheme="http://yoursite.com/tags/clean-code/"/>
    
  </entry>
  
  <entry>
    <title>《代码整洁之道》读书小结</title>
    <link href="http://yoursite.com/2017/03/24/%E3%80%8A%E4%BB%A3%E7%A0%81%E6%95%B4%E6%B4%81%E4%B9%8B%E9%81%93%E3%80%8B%E8%AF%BB%E4%B9%A6%E5%B0%8F%E7%BB%93/"/>
    <id>http://yoursite.com/2017/03/24/《代码整洁之道》读书小结/</id>
    <published>2017-03-24T12:29:05.000Z</published>
    <updated>2017-03-24T08:31:54.000Z</updated>
    
    <content type="html"><![CDATA[<p>最近晚间的加班暂时暂停了，大概已经整整一个月每天焦头烂额的写着业务代码，被各种逻辑搞的整个人都不大好了，好在是写的差不多了。</p>
<p>每当写了很多业务代码之后，我都会停下来反思一个问题，你的代码写的干净么，有需要重构的地方么。而这一次，因为一些临时性的需求变更，我自认为我写了一部分脏代码，这部分代码恰恰是bug的高发地段，而且也可能会带来后期维护的困难。那么如何来重构这部分代码呢？</p>
<p>在我写下这部分脏代码之前，我自认为也是用了一些能够用上的设计模式，但是随着临时性的需求变更不断增加，有时候贪图省事直接在原有代码的基础上修改了事，很明显这违反了开放闭合原则。</p>
<p>回到正题上来，回顾《clean code》这本书，正是帮助自己在反思的同时做好知识的回顾梳理，并且能够在重构中把学到的知识学以致用。虽然现在我还没有全部看完，但是也是可以从已经完成阅读的部分总结一点心得。</p>
<p>第一次看这本书是在几年前，可以说这本书对我编写代码的风格形成了很深的影响，而初读此书时也有种醍醐灌顶的感觉，哦，原来代码还可以这么写。</p>
<a id="more"></a>
<h1 id="从命名谈起"><a href="#从命名谈起" class="headerlink" title="从命名谈起"></a>从命名谈起</h1><p>当我们在写代码时，面临的第一个问题大概就是命名，你想创建一个类，需要命名；写函数，需要命名；甚至初始化一个变量，也需要给变量命名。但是一个好的命名和差的命名，可是有着天差地别的区别的。好的命名，让人扫一眼，就大概知道这个函数的作用是什么，甚至连大体会输出什么都知道，提升了代码的可读性。而差的命名会极大降低代码的可读性，让下一个阅读你代码的人，花费大量的时间。举个栗子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">privite func syncDataWhenConnect() &#123;</div><div class="line">    //doSomething</div><div class="line">&#125;</div><div class="line"></div><div class="line">privite func syncData() &#123;</div><div class="line">    //doSomething</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>上下两个函数，很明显你看完第一个，会更明白这个函数的目的是什么，所以建议在书写函数的时候，尽量的使用动词，来准确的秒数函数的目的。</p>
<p>而给类命名则正好相反，再举个栗子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">AddressManager.php</div><div class="line">MacAddress.php</div></pre></td></tr></table></figure>
<p>上下两个类名，这里我写的有点争议，其实在不同的语境里两个似乎都可以完成可读性的使命，但是假设一个程序，有存储用户地址的类，也有外接设备mac地址的类，哪个更易懂？所以类名的命名，尽量使用名词，并且要求简单直接，是什么就是什么，尽量少用动词，动词的活，让我们所在的文件夹，让命名空间们去阐述吧。</p>
<p>虽然我上面反复提及了名字简短，但是只有很少比例的命名能又短又明确的阐述命名意义，所以如果是为了增加可读性，长命名也不是完全不可取，虽然很多人黑<strong>Objective-C</strong>命名是又臭又长，但是这种命名带来的便利就是你扫一眼便知道函数要完成的目的，以及需要的参数。长短之别，自己把握吧。</p>
<h1 id="从简短代码谈起"><a href="#从简短代码谈起" class="headerlink" title="从简短代码谈起"></a>从简短代码谈起</h1><p>编程界的那帮金字塔尖的大牛们一致认为，函数是越短越好，如果实在控制不住，请不要超过20行，如果不小心超过了，那么你可以考虑拆分你的函数了。</p>
<p>其实每次我去反思这点的时候，我觉得可有意思了，讲道理的说，我有可能做不到，为什么呢，因为水平不够，对语言的理解不够透彻，有很多更深层的语言特性，还不能熟练应用。所以只能在能够考虑到的范围内，尽量缩短自己的函数长度，向大牛们看齐。</p>
<p>这次的手环模块，因为有很多蓝牙的连接状态判断，写了很多Swich ifelse等判断，而ifelse因为业务逻辑复杂，还在初次编写的时候夹杂了很多嵌套，所以需要重构的地方还是很多的。</p>
<p>我们写代码，开发时间算20%，那么剩下的80%就是维护时间，什么样的函数易于修改，当然是短的函数，每次改动都能做到心中有数。</p>
<p>而提到了维护，那么测试又不能不提，很可惜，我还没有看全测试，平时的工作中因为很多是移动端的编码，view层占的比重很大，有时候疏于测试，好好理解，好好实践，再来写下一篇心得吧。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;最近晚间的加班暂时暂停了，大概已经整整一个月每天焦头烂额的写着业务代码，被各种逻辑搞的整个人都不大好了，好在是写的差不多了。&lt;/p&gt;
&lt;p&gt;每当写了很多业务代码之后，我都会停下来反思一个问题，你的代码写的干净么，有需要重构的地方么。而这一次，因为一些临时性的需求变更，我自认为我写了一部分脏代码，这部分代码恰恰是bug的高发地段，而且也可能会带来后期维护的困难。那么如何来重构这部分代码呢？&lt;/p&gt;
&lt;p&gt;在我写下这部分脏代码之前，我自认为也是用了一些能够用上的设计模式，但是随着临时性的需求变更不断增加，有时候贪图省事直接在原有代码的基础上修改了事，很明显这违反了开放闭合原则。&lt;/p&gt;
&lt;p&gt;回到正题上来，回顾《clean code》这本书，正是帮助自己在反思的同时做好知识的回顾梳理，并且能够在重构中把学到的知识学以致用。虽然现在我还没有全部看完，但是也是可以从已经完成阅读的部分总结一点心得。&lt;/p&gt;
&lt;p&gt;第一次看这本书是在几年前，可以说这本书对我编写代码的风格形成了很深的影响，而初读此书时也有种醍醐灌顶的感觉，哦，原来代码还可以这么写。&lt;/p&gt;
    
    </summary>
    
    
      <category term="编码思考" scheme="http://yoursite.com/tags/%E7%BC%96%E7%A0%81%E6%80%9D%E8%80%83/"/>
    
      <category term="代码风格" scheme="http://yoursite.com/tags/%E4%BB%A3%E7%A0%81%E9%A3%8E%E6%A0%BC/"/>
    
      <category term="clean code" scheme="http://yoursite.com/tags/clean-code/"/>
    
  </entry>
  
  <entry>
    <title>在云服务器上部署Laravel</title>
    <link href="http://yoursite.com/2017/03/19/%E5%9C%A8%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E9%83%A8%E7%BD%B2Laravel/"/>
    <id>http://yoursite.com/2017/03/19/在云服务器上部署Laravel/</id>
    <published>2017-03-19T08:27:56.000Z</published>
    <updated>2017-03-19T08:31:27.000Z</updated>
    
    <content type="html"><![CDATA[<p>学习PHP和Laravel已经有一段时间了,但是所有的代码都是跑在本地的虚拟主机上的，于是去腾讯云申请了一个月的免费云主机，想把项目部署到云服务器上。</p>
<p>不得不说这里面的坑实在是有点多，让我这个初次接触服务器的小白摸不清头脑。在配置好服务器之后，部署一个Laravel项目更是费劲心思，于是乎想记录下部署Laravel项目的过程。</p>
<p>PS： Linux真是越用越有感觉的系统，回家在台式机上也要装个Linux敲代码用。</p>
<a id="more"></a>
<h1 id="环境简介"><a href="#环境简介" class="headerlink" title="环境简介"></a>环境简介</h1><p>在操作系统的选择上，我选用了Linux ubuntu16.04的系统，使用的是LNMP的环境，即 Linux + Nginx + Mysql + PHP的环境。</p>
<h2 id="删除Apache"><a href="#删除Apache" class="headerlink" title="删除Apache"></a>删除Apache</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo service apache2 stop</div></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">update-rc.d <span class="_">-f</span> apache2 remove</div></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get remove apache2</div></pre></td></tr></table></figure>
<p>先用这三条命令来删除Apaceh 之后更新一下包列表</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get update</div></pre></td></tr></table></figure>
<h2 id="1-安装Nginx"><a href="#1-安装Nginx" class="headerlink" title="1.安装Nginx"></a>1.安装Nginx</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install nginx</div></pre></td></tr></table></figure>
<p>在安装完Nginx之后，要重启nginx </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo service nginx start</div></pre></td></tr></table></figure>
<p>执行完之后，在浏览器输入云服务器分配给你的公网ip，就可以看到welcome to nginx的界面了</p>
<h2 id="2-安装Mysql"><a href="#2-安装Mysql" class="headerlink" title="2. 安装Mysql"></a>2. 安装Mysql</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install mysql-server mysql-client</div></pre></td></tr></table></figure>
<p>过程中会提示你设置Mysql的密码，就跟平时的密码设置一样，一次输入，一次确认。密码确认完毕后基本等一会就安装好了。尝试</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql -u root -p</div></pre></td></tr></table></figure>
<p>如果登录成功，那Mysql就正确安装了。</p>
<h2 id="3-安装PHP"><a href="#3-安装PHP" class="headerlink" title="3.安装PHP"></a>3.安装PHP</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install php5-fpm php5-cli php5-mcrypt</div></pre></td></tr></table></figure>
<p>只有通过php5-fpm，PHP在Nginx下才能正常运行，遂，安装之。</p>
<p>至于php5-mcrypt，有些PHP框架会依赖于这个，比如Laravel就是，所以也把它装上了。</p>
<p>题外话，这里的php5我自己在部署时安装了php7 如果想尝试的也可以试试。</p>
<h2 id="4-配置PHP"><a href="#4-配置PHP" class="headerlink" title="4.配置PHP"></a>4.配置PHP</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo vim /etc/php5/fpm/php.ini</div></pre></td></tr></table></figure>
<p>打开PHP配置文件，找到cgi.fix_pathinfo选项，去掉它前面的注释分号;，然后将它的值设置为0,如下</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cgi.fix_pathinfo=<span class="number">0</span></div></pre></td></tr></table></figure>
<h2 id="5-启用php5-mcrypt"><a href="#5-启用php5-mcrypt" class="headerlink" title="5. 启用php5-mcrypt:"></a>5. 启用php5-mcrypt:</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo php5enmod mcrypt</div></pre></td></tr></table></figure>
<h2 id="6-重启php5-fpm"><a href="#6-重启php5-fpm" class="headerlink" title="6.重启php5-fpm:"></a>6.重启php5-fpm:</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo service php5-fpm restart</div></pre></td></tr></table></figure>
<p>在搭建完LEMP环境之后，首先要明确两个重要目录</p>
<p><strong>Nginx的默认root文件夹</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/usr/share/nginx/html</div></pre></td></tr></table></figure>
<p><strong>Nginx的服务器配置文件所在目录</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/etc/nginx/sites-available/</div></pre></td></tr></table></figure></p>
<p>上面两个目录记住就好，很常用，先摆出来</p>
<h1 id="下面一步一步在云服务器上部署Laravel"><a href="#下面一步一步在云服务器上部署Laravel" class="headerlink" title="下面一步一步在云服务器上部署Laravel"></a>下面一步一步在云服务器上部署Laravel</h1><h2 id="1-创建网站的根目录"><a href="#1-创建网站的根目录" class="headerlink" title="1.创建网站的根目录"></a>1.创建网站的根目录</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo mkdir -p /var/www</div></pre></td></tr></table></figure>
<h2 id="2-配置nginx服务器"><a href="#2-配置nginx服务器" class="headerlink" title="2.配置nginx服务器"></a>2.配置nginx服务器</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo vim /etc/nginx/sites-available/default</div></pre></td></tr></table></figure>
<p>打开nginx的配置文件之后，找到server这一块，大概是长这个样子的</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">server &#123;</div><div class="line">        listen 80 default_server;</div><div class="line">        listen [::]:80 default_server ipv6only=on;</div><div class="line"></div><div class="line">        root /usr/share/nginx/html;</div><div class="line">        index index.html index.htm;</div><div class="line"></div><div class="line">        server_name localhost;</div><div class="line"></div><div class="line">        location / &#123;</div><div class="line">                try_files <span class="variable">$uri</span> <span class="variable">$uri</span>/ =404;</div><div class="line">        &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>其中root，index ，server_name和location这几行需要稍微修改一下</p>
<p><strong>root修改</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">root /var/www/laravel/public;</div></pre></td></tr></table></figure>
<p>这里就是将nginx服务器的根目录指向Laravel的public文件夹下，后续的Laravel项目的代码我们会放在我们之前创建的/var/www/laravel目录下</p>
<p><strong>index修改</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">index index.php index.html index.htm;</div></pre></td></tr></table></figure>
<p>这里需要注意的是，将index.php排在最前面</p>
<p><strong>server_name修改</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">server_name server_domain_or_IP;</div></pre></td></tr></table></figure>
<p>将server_domain_or_IP修改为你的公网IP</p>
<p><strong>location修改</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">location / &#123;</div><div class="line">        try_files <span class="variable">$uri</span> <span class="variable">$uri</span>/ /index.php?<span class="variable">$query_string</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>修改完是这样的：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">server &#123;</div><div class="line">    listen 80 default_server;</div><div class="line">    listen [::]:80 default_server ipv6only=on;</div><div class="line"></div><div class="line">    root /var/www/laravel/public;</div><div class="line">    index index.php index.html index.htm;</div><div class="line"></div><div class="line">    server_name server_domain_or_IP;</div><div class="line"></div><div class="line">    location / &#123;</div><div class="line">            try_files <span class="variable">$uri</span> <span class="variable">$uri</span>/ /index.php?<span class="variable">$query_string</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>最后我们还需要配置一下Nginx，让其执行PHP文件。同样是在这个文件里，在location下方添加下面的配置：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">server &#123;</div><div class="line">    listen 80 default_server;</div><div class="line">    listen [::]:80 default_server ipv6only=on;</div><div class="line"></div><div class="line">    root /var/www/laravel/public;</div><div class="line">    index index.php index.html index.htm;</div><div class="line"></div><div class="line">    server_name server_domain_or_IP;</div><div class="line"></div><div class="line">    location / &#123;</div><div class="line">        try_files <span class="variable">$uri</span> <span class="variable">$uri</span>/ /index.php?<span class="variable">$query_string</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    location ~ \.php$ &#123;</div><div class="line">        try_files <span class="variable">$uri</span> /index.php =404;</div><div class="line">        fastcgi_split_path_info ^(.+\.php)(/.+)$;</div><div class="line">        fastcgi_pass unix:/var/run/php5-fpm.sock;</div><div class="line">        fastcgi_index index.php;</div><div class="line">        fastcgi_param SCRIPT_FILENAME <span class="variable">$document_root</span><span class="variable">$fastcgi_script_name</span>;</div><div class="line">        include fastcgi_params;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>注意，最下面的<code>location ~ \.php$</code>是自己加上去的：</p>
<p>配置完之后重启Nginx，使上面的配置项生效。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo service nginx restart</div></pre></td></tr></table></figure>
<h2 id="3-创建Laravel项目"><a href="#3-创建Laravel项目" class="headerlink" title="3.创建Laravel项目"></a>3.创建Laravel项目</h2><p>在配置完nginx后，怎么获取Laravel的项目代码呢？有以下几种方法：</p>
<p><strong>(1).直接composer安装</strong></p>
<p>直接通过composer来安装，你可以在服务器上通过执行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">cd</span> ~</div><div class="line">curl <span class="_">-s</span>S https://getcomposer.org/installer | php</div></pre></td></tr></table></figure>
<p>上面命令会安装composer</p>
<p>composer全局使用：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo mv composer.phar /usr/<span class="built_in">local</span>/bin/composer</div></pre></td></tr></table></figure>
<p>然后在/var/www目录下直接执行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo composer create-project laravel/laravel laravel</div></pre></td></tr></table></figure>
<p>因为我们之前创建/var/www目录，你可以直接cd /var/www然后执行上面的命令。然后坐等安装完成。</p>
<p><strong>(2).直接上传代码</strong></p>
<p>使用下面命令上传</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">scp -r laravel root@your_IP:</div></pre></td></tr></table></figure>
<p>然后在服务器上将laravel移动到/var/www目录下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo mv laravel/ /var/www</div></pre></td></tr></table></figure>
<p>(3).使用Git和Coding平台</p>
<p>个人比较喜欢使用git来上传代码，可以很方便的更新代码和进行回滚，一旦版本更新出Bug我可以借助Git的强大版本管理能力来修复Bug。流程大概是这样：</p>
<p>本地代码－－－－&gt;Github－－－－&gt;云服务器<br>既然要使用git，那么先在云服务器上安装git：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install git</div></pre></td></tr></table></figure>
<p>安装完成就可以使用git了，然后在Github上创建一个私有项目laravel，里面包含所有该Laravel项目所需代码。</p>
<p>一旦本地代码都推送到Coding，然后在/var/www目录下直接使用</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git <span class="built_in">clone</span> your-project-git-link</div></pre></td></tr></table></figure>
<p>your-project-git-link替换为你Github上的laravel项目地址</p>
<h2 id="5-BINGO"><a href="#5-BINGO" class="headerlink" title="5.BINGO"></a>5.BINGO</h2><p>在浏览器输入：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://server_domain_or_IP</div></pre></td></tr></table></figure>
<p>至此，你可以在服务器上随意地用Laravel了,keep coding!</p>
<h3 id="终极tips：-有了问题，页面出不来-各种错误-一定不要胡乱的调试，记得看log，非常有用。"><a href="#终极tips：-有了问题，页面出不来-各种错误-一定不要胡乱的调试，记得看log，非常有用。" class="headerlink" title="终极tips： 有了问题，页面出不来 各种错误 一定不要胡乱的调试，记得看log，非常有用。"></a>终极tips： 有了问题，页面出不来 各种错误 一定不要胡乱的调试，记得看log，非常有用。</h3>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;学习PHP和Laravel已经有一段时间了,但是所有的代码都是跑在本地的虚拟主机上的，于是去腾讯云申请了一个月的免费云主机，想把项目部署到云服务器上。&lt;/p&gt;
&lt;p&gt;不得不说这里面的坑实在是有点多，让我这个初次接触服务器的小白摸不清头脑。在配置好服务器之后，部署一个Laravel项目更是费劲心思，于是乎想记录下部署Laravel项目的过程。&lt;/p&gt;
&lt;p&gt;PS： Linux真是越用越有感觉的系统，回家在台式机上也要装个Linux敲代码用。&lt;/p&gt;
    
    </summary>
    
    
      <category term="Linux" scheme="http://yoursite.com/tags/Linux/"/>
    
      <category term="php" scheme="http://yoursite.com/tags/php/"/>
    
      <category term="Laravel部署" scheme="http://yoursite.com/tags/Laravel%E9%83%A8%E7%BD%B2/"/>
    
  </entry>
  
  <entry>
    <title>Laravel —— 路由的学习笔记</title>
    <link href="http://yoursite.com/2017/03/04/Laravel-%E2%80%94%E2%80%94-%E8%B7%AF%E7%94%B1%E7%9A%84%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>http://yoursite.com/2017/03/04/Laravel-——-路由的学习笔记/</id>
    <published>2017-03-04T10:52:30.000Z</published>
    <updated>2017-03-04T10:53:41.000Z</updated>
    
    <content type="html"><![CDATA[<p>最近的工作非常忙，公司从项目紧张起来之后，一直在实施996加班制度，工作强度虽然如此，但是任然要利用有限的空余时间来学习。之前都有在前端方面的学习，所以一直想学习PHP，好把前后端的知识能贯穿起来做。现在有个很小的目标就是完成自己的第一个前后端串联的作品。</p>
<p>在一周之前开始系统学习PHP，在把语法过完之后，就开始找寻自己想首先研习的框架，方案有很多，最后我还是在众多方案中选择了<code>Laravel</code>，理由很简单 —— 优雅编程。</p>
<a id="more"></a>
<p>我一直觉得编程都不是一件枯燥的事情，能够把一个复杂的逻辑用简洁清晰的代码呈现出来，是一件很棒的事情。但是奈何功力尚浅，有时候空有一个优雅的开头，却在之后越来越复杂的业务逻辑中迷失了初心。所以首先选择一个以优雅著称的框架，之后慢慢修炼自己，写出美的代码才是正道。</p>
<p>吐槽完毕，咱来正式的记录下学习Laravel框架的一些笔记，因为之前配置开发环境的什么的网上的blog一抓一大把，我也在上面吐了三升血，所以咱一句都不提开发环境的配置了。如果你配置好了开发环境，看到了<code>Laravel 5</code>这个标题，那么，我们就正式与Laravel见面了。</p>
<p>新手第一次用Laravel，必须先掌握的一个知识点就是路由 —— <code>Route</code>, 因为之前在做iOS开发时，iOS的设计模式里也提出过路由的概念，我也大致的了解过，所以对于路由我并不陌生，熟悉了Laravel<code>Route</code>之后，诚实的说Laravel又一次提升了我对路由系统的认知，不由得感叹这个Laravel中路由系统的强大和优美，尤其当你把他和中间件结合起来看的时候。不过由于学习Laravel时间过短，我所能感受到的也只是皮毛而已。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Route::get(<span class="string">'homepage'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> view(<span class="string">'welcome'</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>举个🌰，上面的代码是Laravel中最基本的路由设置，<strong>get</strong>后面的<strong>‘homepage’</strong>说明这个路由的跳转域名就是<strong>index/homepage</strong>,而返回的操作则是<code>return view(&#39;welcome&#39;)</code>,即为跳转到view层的welcome界面。只接受来自HTTP的GET请求。</p>
<p>上面的讲解，会让你很清晰的理解这段代码到底是什么意思。而这种一目了然也是Laravel的优雅之一。</p>
<p>至于其余的，我觉得文档应该比我讲的更明白，我也就不拿例子出来讲了。若是学习笔记等同于抄文档，那也失去了意义，更倾向于写一些心得体会。PHP的路，还很漫长呢。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;最近的工作非常忙，公司从项目紧张起来之后，一直在实施996加班制度，工作强度虽然如此，但是任然要利用有限的空余时间来学习。之前都有在前端方面的学习，所以一直想学习PHP，好把前后端的知识能贯穿起来做。现在有个很小的目标就是完成自己的第一个前后端串联的作品。&lt;/p&gt;
&lt;p&gt;在一周之前开始系统学习PHP，在把语法过完之后，就开始找寻自己想首先研习的框架，方案有很多，最后我还是在众多方案中选择了&lt;code&gt;Laravel&lt;/code&gt;，理由很简单 —— 优雅编程。&lt;/p&gt;
    
    </summary>
    
    
      <category term="PHP" scheme="http://yoursite.com/tags/PHP/"/>
    
      <category term="Laravel" scheme="http://yoursite.com/tags/Laravel/"/>
    
      <category term="Route" scheme="http://yoursite.com/tags/Route/"/>
    
  </entry>
  
  <entry>
    <title>Swift中的警卫队</title>
    <link href="http://yoursite.com/2017/02/22/Swift%E4%B8%AD%E7%9A%84%E8%AD%A6%E5%8D%AB%E9%98%9F/"/>
    <id>http://yoursite.com/2017/02/22/Swift中的警卫队/</id>
    <published>2017-02-22T11:12:03.000Z</published>
    <updated>2017-02-22T11:13:29.000Z</updated>
    
    <content type="html"><![CDATA[<p>大半个月没有更新自己的博客了，最近在忙一个新项目时间非常紧张，所以最近的博客更新进度就要稍微放缓一点了。</p>
<p>这个项目是纯粹的Swift项目，所以最近的博客会结合自己在使用Swift这门语言的过程中，对Swift的总结和感悟。今天就来介绍一下能让你在Swift中如虎添翼的警卫队成员 —— <code>guard</code>。</p>
<p>我们在编写业务代码中，经常会遇到的一种情况就是一大串的<strong>if else*，一层又一层的甚至还有嵌套，看的眼花缭乱，有时候根本不知道跑到了哪一层了，代码的可读性非常差。而在Swift里有比</strong>if else**更优雅的写法，那就是<code>guard</code>。</p>
<a id="more"></a>
<h2 id="使用-guard-来判断-nil"><a href="#使用-guard-来判断-nil" class="headerlink" title="使用 guard 来判断 nil"></a>使用 guard 来判断 nil</h2><p>传统的Objective-C在判断<strong>nil</strong>的时候，会用下面的写法:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (something == <span class="literal">nil</span>) &#123;</div><div class="line">    <span class="comment">// doSomething</span></div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="comment">// throw error</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>而若是我们改用<strong>guard</strong>来实现的话会是下面的情况:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">guard</span> (something == <span class="literal">nil</span>) <span class="keyword">else</span> &#123;</div><div class="line">    <span class="comment">// throw error</span></div><div class="line">    <span class="keyword">return</span> <span class="comment">// guard 裡面一定要有 return</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// doSomething</span></div></pre></td></tr></table></figure>
<p>改成这样，判断并不会一层一层的累加下去，代码看上去也比之前美观易懂了很多，但是要注意的是不要搞错逻辑，免得直接<strong>return</strong>了。</p>
<p>而这样的用法也符合<a href="https://github.com/github/swift-style-guide" target="_blank" rel="external">Swift编码规范</a>所强调的那样，尽早的<code>Return</code>或者<code>break</code>。</p>
<h2 id="使用-guard-来判断类型"><a href="#使用-guard-来判断类型" class="headerlink" title="使用 guard 来判断类型"></a>使用 guard 来判断类型</h2><p>介于Swift里的Optional类型的增加，我们有时候也可以使用<strong>guard</strong>来判断一个属性的类型。例如如下代码所做的那样:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 声明的function</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">doSomething</span><span class="params">(input: Bool, handler: <span class="params">(obj: AnyObject?)</span></span></span> -&gt; <span class="type">Void</span>) -&gt; <span class="type">Void</span> &#123;</div><div class="line">    <span class="keyword">let</span> someDict: [<span class="type">Int</span>: <span class="type">String</span>] = [<span class="number">1</span>: <span class="string">"One"</span>, <span class="number">2</span>: <span class="string">"Two"</span>, <span class="number">3</span>: <span class="string">"Three"</span>]</div><div class="line"></div><div class="line">    <span class="keyword">if</span> input &#123;</div><div class="line">        handler(obj: someDict)</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        handler(obj: [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 执行函数</span></div><div class="line">doSomething(<span class="literal">true</span>) &#123; (obj) -&gt; <span class="type">Void</span> <span class="keyword">in</span></div><div class="line">    <span class="comment">// 判断是否为 [Int:String] 的类型(Dictionary)</span></div><div class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> someDict = obj <span class="keyword">as</span>? [<span class="type">Int</span>:<span class="type">String</span>] <span class="keyword">else</span> &#123;</div><div class="line">        <span class="built_in">print</span>(<span class="string">"obj not match dictionary"</span>)</div><div class="line">        <span class="keyword">return</span></div><div class="line">    &#125;</div><div class="line">    <span class="comment">// 将 Dictionary 里面每个 value 打印出来</span></div><div class="line">    <span class="keyword">for</span> (key, value) <span class="keyword">in</span> someDict &#123;</div><div class="line">        <span class="built_in">print</span>(<span class="string">"Dictionary key <span class="subst">\(key)</span> -  Dictionary value <span class="subst">\(value)</span>"</span>)</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// 自行输入 key 但会印出 Optional</span></div><div class="line">    <span class="built_in">print</span>( <span class="string">"Value of key = 1 is <span class="subst">\(someDict[<span class="number">1</span>])</span>"</span> )</div><div class="line">    <span class="built_in">print</span>( <span class="string">"Value of key = 2 is <span class="subst">\(someDict[<span class="number">2</span>])</span>"</span> )</div><div class="line">    <span class="built_in">print</span>( <span class="string">"Value of key = 3 is <span class="subst">\(someDict[<span class="number">3</span>])</span>"</span> )</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>通过上面的🌰，我们已经可以看到一个如何对可选类型解包的操作了。许多人在初入Swift的大门时，经常被可选类型搞的程序Crash，所以学以致用，用上优雅的警卫队吧。让他来帮助你实现更加优雅健壮的代码。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;大半个月没有更新自己的博客了，最近在忙一个新项目时间非常紧张，所以最近的博客更新进度就要稍微放缓一点了。&lt;/p&gt;
&lt;p&gt;这个项目是纯粹的Swift项目，所以最近的博客会结合自己在使用Swift这门语言的过程中，对Swift的总结和感悟。今天就来介绍一下能让你在Swift中如虎添翼的警卫队成员 —— &lt;code&gt;guard&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;我们在编写业务代码中，经常会遇到的一种情况就是一大串的&lt;strong&gt;if else*，一层又一层的甚至还有嵌套，看的眼花缭乱，有时候根本不知道跑到了哪一层了，代码的可读性非常差。而在Swift里有比&lt;/strong&gt;if else**更优雅的写法，那就是&lt;code&gt;guard&lt;/code&gt;。&lt;/p&gt;
    
    </summary>
    
    
      <category term="Swift" scheme="http://yoursite.com/tags/Swift/"/>
    
      <category term="guard" scheme="http://yoursite.com/tags/guard/"/>
    
  </entry>
  
  <entry>
    <title>iOS开发——影响图形性能的因素以及检测方法</title>
    <link href="http://yoursite.com/2017/02/08/iOS%E5%BC%80%E5%8F%91%E2%80%94%E2%80%94%E5%BD%B1%E5%93%8D%E5%9B%BE%E5%BD%A2%E6%80%A7%E8%83%BD%E7%9A%84%E5%9B%A0%E7%B4%A0%E4%BB%A5%E5%8F%8A%E6%A3%80%E6%B5%8B%E6%96%B9%E6%B3%95/"/>
    <id>http://yoursite.com/2017/02/08/iOS开发——影响图形性能的因素以及检测方法/</id>
    <published>2017-02-08T02:32:37.000Z</published>
    <updated>2017-02-08T02:33:47.000Z</updated>
    
    <content type="html"><![CDATA[<p>我想各位攻城狮们肯定听过一句话：“过早的优化是万恶之源”。若是你有着丰富的项目经验，一定会对这句话有着自己的体会，而若是编程新手，那么，请牢记这句话。在一个项目开发到后期，优化就会成为一个不可避免的话题，而这时，优化以及性能问题又显得尤为重要。</p>
<p>本文讨论的是iOS的图形性能问题。</p>
<a id="more"></a>
<h1 id="影响性能的因素"><a href="#影响性能的因素" class="headerlink" title="影响性能的因素"></a>影响性能的因素</h1><p>1、 <strong>CALayer</strong>的<strong>shouldRasterize</strong>(光栅化)</p>
<p>这个属性看上去很不好理解，光栅化是将几何数据经过一系列变换后最终转换为像素，从而呈现在显示设备上的过程。光栅化的本质是坐标变换、几何离散化。</p>
<p>把<strong>layer</strong>的<strong>shouldRasterize</strong>设为<strong>YES</strong>后，<strong>CALayer</strong>会被光栅化为<strong>bitmap</strong>，<strong>layer</strong>的阴影等效果也会被保存到<strong>bitmap</strong>中作为缓存。在使用了<strong>shadow</strong>或<strong>cornerRadius</strong>等效果时，缓存使性能得到提升。</p>
<p>但是在使用这个属性前，需要明确3点：</p>
<ul>
<li><p>更新已经光栅化的<strong>CALayer</strong>会造成离屏渲染</p>
</li>
<li><p>被光栅化的<strong>bitmap</strong>如果超过100ms没有被使用则会被移除</p>
</li>
<li><p>系统限制缓存的大小为<strong>2.5 x screen size</strong></p>
</li>
</ul>
<p>2、<strong>Offscreen rendering</strong>(离屏渲染)</p>
<p>讨论造成离屏渲染的原因之前，先说明什么是离屏渲染：离屏渲染指的是在图像在绘制到当前屏幕前,需要先进行一次渲染,之后才绘制到当前屏幕。在第一次渲染时，<strong>GPU(Core Animation)</strong>或<strong>CPU(Core Graphics)</strong>需要额外的一块内存来进行渲染，完成后再绘制到屏幕。<strong>offscreen</strong>到<strong>onscreen</strong>需要进行上下文切换，这个切换的性能消耗是昂贵的。</p>
<p>因此，我们必须避免不必要的离屏渲染。</p>
<p>造成离屏渲染的原因有：</p>
<ul>
<li>设置<code>CALayer</code>的<code>cornerRadiu</code>，<code>edgeAntialiasingMask</code>，<code>allowsEdgeAntialiasing</code>属性</li>
<li>把<code>CALayer</code>的<code>maskToBounds</code>设为<code>YES</code></li>
<li>设置<code>CALayer</code>的<code>shadow</code>属性</li>
<li>设置<code>CALayer</code>的<code>mask</code>属性</li>
<li>把<code>CALayer</code>的<code>allowsGroupOpacity</code>属性设为<code>YES</code>而且<code>opacity</code>小于1</li>
</ul>
<p>等等…</p>
<p>由此可见，很多常用属性都会造成离屏渲染，在性能要求高的地方，就需要使用另外的实现方案。比如使用<code>shadowPath</code>代替使用<code>shadow+shadowOffset+shadowColor</code>；在需要使用圆形图片的<code>tableview</code>里，使用<code>cornerRadius</code>设置圆角是下下之选，可以用一张中间为透明圆形的图片进行遮盖来达到圆形的效果，或者在使用前就把图片裁剪为圆形。</p>
<p>3、Blending(混合绘制)</p>
<p>GPU会放弃绘制那些完全被其他图层遮盖的内容。如果两个图层叠加在一起，上面的图层不是完全不透明的，那么GPU便会计算合并两个图层的透明重叠像素，这个过程便是<code>blending</code>，这同样也是一个消耗资源的过程。</p>
<p>因此，不要随便把一个视图或图层的<code>backgroundColor</code>设为透明。</p>
<h1 id="使用Instrument进行检查"><a href="#使用Instrument进行检查" class="headerlink" title="使用Instrument进行检查"></a>使用Instrument进行检查</h1><p>用<code>Xcode</code>打开你的项目，选择工具栏上的<code>Product-&gt;Profile</code>，编译成功后会打开<code>Instrument</code>，在<code>Choose a profile template</code>页面下选择<code>Core Animation</code>，进入主界面。(如果需要检测动画帧数，需要使用真机)</p>
<p>点击左上方红色的录制按钮，开始检测：</p>
<p><img src="https://raw.githubusercontent.com/lizhijiang/BlogPhotos/master/2015-08-03-1.png" alt=""></p>
<p>在页面右下方，有一系列的复选框，利用这几个选项，我们可以很轻松的检查上面所提到的问题：(下面解释摘抄自iOS核心动画高级技巧第十二章)</p>
<ul>
<li><p><strong>Color Blended Layers</strong> - 这个选项基于渲染程度对屏幕中的混合区域进行绿到红的高亮（也就是多个半透明图层的叠加）。由于重绘的原因，混合对GPU性能会有影响，同时也是滑动或者动画帧率下降的罪魁祸首之一。</p>
</li>
<li><p><strong>ColorHitsGreenandMissesRed</strong> - 当使用<code>shouldRasterizep</code>属性的时候，耗时的图层绘制会被缓存，然后当做一个简单的扁平图片呈现。当缓存再生的时候这个选项就用红色对栅格化图层进行了高亮。如果缓存频繁再生的话，就意味着栅格化可能会有负面的性能影响了。</p>
</li>
<li><p><strong>Color Copied Images</strong> - 有时候寄宿图片的生成意味着<code>Core Animation</code>被强制生成一些图片，然后发送到渲染服务器，而不是简单的指向原始指针。这个选项把这些图片渲染成蓝色。复制图片对内存和CPU使用来说都是一项非常昂贵的操作，所以应该尽可能的避免。</p>
</li>
<li><p><strong>Color Immediately</strong> - 通常<code>Core Animation Instruments</code>以每毫秒10次的频率更新图层调试颜色。对某些效果来说，这显然太慢了。这个选项就可以用来设置每帧都更新（可能会影响到渲染性能，而且会导致帧率测量不准，所以不要一直都设置它）。</p>
</li>
<li><p><strong>Color Misaligned Images</strong> - 这里会高亮那些被缩放或者拉伸以及没有正确对齐到像素边界的图片（也就是非整型坐标）。这些中的大多数通常都会导致图片的不正常缩放，如果把一张大图当缩略图显示，或者不正确地模糊图像，那么这个选项将会帮你识别出问题所在。</p>
</li>
<li><p><strong>Color Offscreen-Rendered Yellow</strong> - 这里会把那些需要离屏渲染的图层高亮成黄色。这些图层很可能需要用<code>shadowPath</code>或者<code>shouldRasterize</code>来优化。</p>
</li>
<li><p><strong>Color OpenGL Fast Path Blue</strong> - 这个选项会对任何直接使用OpenGL绘制的图层进行高亮。如果仅仅使用UIKit或者Core Animation的API，那么不会有任何效果。如果使用<code>GLKView</code>或者<code>CAEAGLLayer</code>，那如果不显示蓝色块的话就意味着你正在强制CPU渲染额外的纹理，而不是绘制到屏幕。</p>
</li>
<li><p><strong>Flash Updated Regions</strong> - 这个选项会对重绘的内容高亮成黄色（也就是任何在软件层面使用<code>Core Graphics</code>绘制的图层）。这种绘图的速度很慢。如果频繁发生这种情况的话，这意味着有一个隐藏的bug或者说通过增加缓存或者使用替代方案会有提升性能的空间。</p>
</li>
</ul>
<p>需要注意的重点是这3个：</p>
<ul>
<li><strong>Color Blended Layers</strong></li>
</ul>
<p>勾选后，检查你的应用界面，<code>blended layer</code>会显示为红色，不透明的为绿色，红色越少越好，如果你的界面一片红海，那就是时候好好优化了。</p>
<ul>
<li><strong>ColorHitsGreenandMissesRed</strong></li>
</ul>
<p>勾选后，如果在你使用了<code>shouldRasterize</code>的地方界面显示为绿色，则表示使用正确性能良好，如果为红色，则需要考虑优化了。(第一次加载时会显示红色，因为这时还没缓存成功，需要检测重用的过程中(比如<code>tableview</code>上下滚动)的变化)</p>
<ul>
<li><strong>Color Offscreen-Rendered Yellow</strong></li>
</ul>
<p>如上所述，离屏渲染的地方都标记为黄色。并非所有的黄色区域都是需要优化的，比如<code>UINavigationBar</code>，因为需要做背景模糊效果，因此它需要离屏渲染。</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>上述的很多原因分析，希望大家不要有强迫症的感觉，要求自己的所有项目必须按这个标准执行，因为这是不可能的，只是给大家提供一个优化方向，以及出了性能问题以后的分析依据。但是在日常的编码过程中，也要时刻把性能的意识放在心上，写出优秀的代码。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;我想各位攻城狮们肯定听过一句话：“过早的优化是万恶之源”。若是你有着丰富的项目经验，一定会对这句话有着自己的体会，而若是编程新手，那么，请牢记这句话。在一个项目开发到后期，优化就会成为一个不可避免的话题，而这时，优化以及性能问题又显得尤为重要。&lt;/p&gt;
&lt;p&gt;本文讨论的是iOS的图形性能问题。&lt;/p&gt;
    
    </summary>
    
    
      <category term="iOS开发" scheme="http://yoursite.com/tags/iOS%E5%BC%80%E5%8F%91/"/>
    
      <category term="性能优化" scheme="http://yoursite.com/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
    
      <category term="Instruments" scheme="http://yoursite.com/tags/Instruments/"/>
    
  </entry>
  
  <entry>
    <title>高性能设置圆角，告别离屏渲染</title>
    <link href="http://yoursite.com/2017/02/06/%E9%AB%98%E6%80%A7%E8%83%BD%E8%AE%BE%E7%BD%AE%E5%9C%86%E8%A7%92%EF%BC%8C%E5%91%8A%E5%88%AB%E7%A6%BB%E5%B1%8F%E6%B8%B2%E6%9F%93/"/>
    <id>http://yoursite.com/2017/02/06/高性能设置圆角，告别离屏渲染/</id>
    <published>2017-02-06T07:27:03.000Z</published>
    <updated>2017-02-06T07:28:07.000Z</updated>
    
    <content type="html"><![CDATA[<p>今天来写一个老生常谈的话题，也是一个面试的高频问题，我也在面试时不止一次被问到过这个问题——如何高性能的设置圆角。就用他作为2017年春节上班之后的第一篇文章。</p>
<h1 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h1><p>在谈及圆角这个话题之前，我们必须先知道系统的<code>API</code>是怎样去简单方便的设置圆角的。以一个<code>imageView</code>控件来举例。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">imageView.layer.cornerRadius = <span class="built_in">CGFloat</span>(<span class="number">10</span>);</div></pre></td></tr></table></figure>
<a id="more"></a>
<p>简单粗暴，就能设置圆角。而在这里的一行代码，必须为它洗白一件事情，设置圆角的这行代码，本身并不会带来任何的性能损耗。如果诸位看官看到此处不相信，大可打开<code>Instruments</code>用<code>Core Animation</code>来试试看，你就会发现既没有<code>Off-Screen Render</code>,也不会出现掉帧的情况。至于使用<code>Instruments</code>来对<code>UIKit</code>进行分析调试，到时候再写一篇文章来详解好了。</p>
<p>但是，如果你给一个<code>UILabel</code>也使用了上面的一行代码，你会发现这个<code>UILabel</code>并不会有任何的变化，可是我们确实实实在在的为它设置了圆角属性。也就是说，很多时候这个属性对于内部还有子视图的控件是无能为力的。所以很多时候，我们会这么来设置圆角。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">imageView.layer.cornerRadius = <span class="built_in">CGFloat</span>(<span class="number">10</span>);</div><div class="line">imageView.layer.masksToBounds = <span class="literal">YES</span>;</div></pre></td></tr></table></figure>
<p>这时候咱们再打开<code>Instruments</code>去观察，恶心的离屏渲染如约而至。</p>
<p>这里我在稍微赘述一下离屏渲染的概念，什么是离屏渲染呢？</p>
<blockquote>
<p>讨论造成离屏渲染的原因之前，先说明什么是离屏渲染：离屏渲染指的是在图像在绘制到当前屏幕前,需要先进行一次渲染,之后才绘制到当前屏幕。在第一次渲染时，GPU(Core Animation)或CPU(Core Graphics)需要额外的一块内存来进行渲染，完成后再绘制到屏幕。offscreen到onscreen需要进行上下文切换，这个切换的性能消耗是昂贵的。</p>
<p>因此，我们必须避免不必要的离屏渲染。</p>
</blockquote>
<p>造成离屏渲染的原因有：</p>
<ul>
<li><p>设置CALayer的cornerRadius，edgeAntialiasingMask，allowsEdgeAntialiasing属性</p>
</li>
<li><p>把CALayer的maskToBounds设为YES</p>
</li>
<li><p>设置CALayer的shadow属性</p>
</li>
<li><p>设置CALayer的mask属性</p>
</li>
<li><p>把CALayer的allowsGroupOpacity属性设为YES而且opacity小于1</p>
</li>
</ul>
<p>讲到这里，大家大可不必对离屏渲染产生巨大的恐慌，因为当一个界面的圆角图片不够多的时候，对性能的损耗影响基本可以忽略不计。所以这里的圆角优化是针对一屏有很多个圆角的应用来说的。</p>
<h1 id="UIImageView-添加圆角"><a href="#UIImageView-添加圆角" class="headerlink" title="UIImageView 添加圆角"></a>UIImageView 添加圆角</h1><p>一般我们最常见的是为<code>UIImageView</code>添加圆角，首先重要的事情放到前面讲，千万避免通过重写<code>drawRect</code>方法来设置圆角，不恰当的使用这个方法，会导致内存的暴增。其次，这种方法的同样会导致离屏渲染。</p>
<p>而一个比较理想的实现思路，是直接截取图片。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">CGSize</span> size = <span class="keyword">self</span>.bounds.size;</div><div class="line">    <span class="built_in">CGFloat</span> scale = [<span class="built_in">UIScreen</span> mainScreen].scale;</div><div class="line">    <span class="built_in">CGSize</span> cornerRadii = <span class="built_in">CGSizeMake</span>(cornerRadius, cornerRadius);</div><div class="line">    </div><div class="line">    <span class="built_in">UIGraphicsBeginImageContextWithOptions</span>(size, <span class="literal">YES</span>, scale);</div><div class="line">    <span class="built_in">CGContextRef</span> currentContext = <span class="built_in">UIGraphicsGetCurrentContext</span>();</div><div class="line">    <span class="keyword">if</span> (<span class="literal">nil</span> == currentContext) &#123;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">UIBezierPath</span> *cornerPath = [<span class="built_in">UIBezierPath</span> bezierPathWithRoundedRect:<span class="keyword">self</span>.bounds byRoundingCorners:rectCornerType cornerRadii:cornerRadii];</div><div class="line">    <span class="built_in">UIBezierPath</span> *backgroundRect = [<span class="built_in">UIBezierPath</span> bezierPathWithRect:<span class="keyword">self</span>.bounds];</div><div class="line">    [backgroundColor setFill];</div><div class="line">    [backgroundRect fill];</div><div class="line">    [cornerPath addClip];</div><div class="line">    [<span class="keyword">self</span>.layer renderInContext:currentContext];</div><div class="line">    [<span class="keyword">self</span> drawBorder:cornerPath];</div><div class="line">    <span class="built_in">UIImage</span> *processedImage = <span class="built_in">UIGraphicsGetImageFromCurrentImageContext</span>();</div><div class="line">    <span class="built_in">UIGraphicsEndImageContext</span>();</div><div class="line">    <span class="keyword">if</span> (processedImage) &#123;</div><div class="line">        objc_setAssociatedObject(processedImage, &amp;kProcessedImage, @(<span class="number">1</span>), OBJC_ASSOCIATION_RETAIN_NONATOMIC);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">self</span>.image = processedImage;</div></pre></td></tr></table></figure>
<p>上面这段代码我只是给出了大致的实现思路，圆角路径直接用贝塞尔曲线绘制，而其中的属性，使用了<code>runtime</code>的黑魔法去设置，在<strong>Category</strong> 给一个现有的类添加属性，但是却不能添加实例变量，这似乎成为了 <strong>Objective-C</strong>的一个明显短板。然而值得庆幸的是，我们可以通过 <strong>Associated Objects</strong>来弥补这一不足。</p>
<p>至于完整的Demo和方法库，网上已经有很多了，Github动手搜索吧。</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><ol>
<li><p>如果能够只用 cornerRadius 解决问题，就不用优化。</p>
</li>
<li><p>如果必须设置 masksToBounds，可以参考圆角视图的数量，如果数量较少（一页只有几个）也可以考虑不用优化。</p>
</li>
<li><p>UIImageView 的圆角通过直接截取图片实现，其它视图的圆角可以通过 Core Graphics 画出圆角矩形实现。</p>
</li>
</ol>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;今天来写一个老生常谈的话题，也是一个面试的高频问题，我也在面试时不止一次被问到过这个问题——如何高性能的设置圆角。就用他作为2017年春节上班之后的第一篇文章。&lt;/p&gt;
&lt;h1 id=&quot;起因&quot;&gt;&lt;a href=&quot;#起因&quot; class=&quot;headerlink&quot; title=&quot;起因&quot;&gt;&lt;/a&gt;起因&lt;/h1&gt;&lt;p&gt;在谈及圆角这个话题之前，我们必须先知道系统的&lt;code&gt;API&lt;/code&gt;是怎样去简单方便的设置圆角的。以一个&lt;code&gt;imageView&lt;/code&gt;控件来举例。&lt;/p&gt;
&lt;figure class=&quot;highlight objc&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;imageView.layer.cornerRadius = &lt;span class=&quot;built_in&quot;&gt;CGFloat&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;);&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
      <category term="iOS开发" scheme="http://yoursite.com/tags/iOS%E5%BC%80%E5%8F%91/"/>
    
      <category term="性能优化" scheme="http://yoursite.com/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
    
      <category term="圆角" scheme="http://yoursite.com/tags/%E5%9C%86%E8%A7%92/"/>
    
      <category term="离屏渲染" scheme="http://yoursite.com/tags/%E7%A6%BB%E5%B1%8F%E6%B8%B2%E6%9F%93/"/>
    
  </entry>
  
  <entry>
    <title>iOS开发——推送跳转到指定页面</title>
    <link href="http://yoursite.com/2017/01/24/iOS%E5%BC%80%E5%8F%91%E2%80%94%E2%80%94%E6%8E%A8%E9%80%81%E8%B7%B3%E8%BD%AC%E5%88%B0%E6%8C%87%E5%AE%9A%E9%A1%B5%E9%9D%A2/"/>
    <id>http://yoursite.com/2017/01/24/iOS开发——推送跳转到指定页面/</id>
    <published>2017-01-24T05:54:23.000Z</published>
    <updated>2017-01-24T05:56:11.000Z</updated>
    
    <content type="html"><![CDATA[<p>眨眼2016年就这么走到了结尾，再过两天新年就要开始了。回顾从2016年开始养成的写博客的习惯，一直能延续下来，保持了一整年，还是比较欣慰的一件事情。希望2017年自己的技术能够继续稳步的提升。</p>
<p>今天在这2016年的最后一篇博客里，咱来聊聊推送通知的跳转。</p>
<p>当推送通知到达时，点击推送通知跳转到指定界面，是很多应用都会碰到的一个需求，而要实现这个功能，解决的方法也很多，若是去谷歌搜索，有一个万能跳转的文章可能会进入您的眼帘，但是我实际的去看了这个项目的源码之后，感觉这个库有一定的局限性，用<strong>runtime</strong>实现跳转这不假，但是在请求字段里加上了<code>ViewController</code>的类名，这其实就是局限的地方了，毕竟除了服务咱们<strong>iOS</strong>端，你也得考虑考虑安卓端的攻城狮不是，然而如果你换一个约定的字段再来解析，那倒不如用<code>URL</code>来作为判断依据更为方便。</p>
<a id="more"></a>
<p>之前的几篇文章，我也在研究<strong>iOS</strong>开发的组件化的架构模式，也有的应用在走组件化的道路上使用了<code>URL</code>来跳转界面完成解耦，在实现推送时，我们也能沿用这个思路，用<code>URL</code>实现界面的跳转。关于使用哪个<code>Router</code>框架，其实真的是萝卜青菜各有所爱，很成熟的 <a href="https://github.com/joeldev/JLRoutes" target="_blank" rel="external">JLRoutes</a>、 <a href="https://github.com/clayallsopp/routable-ios" target="_blank" rel="external">routable-ios</a>、 <a href="https://github.com/lightory/HHRouter" target="_blank" rel="external">HHRouter</a>、 <a href="https://github.com/mogujie/MGJRouter" target="_blank" rel="external">MGJRouter</a>，在经过比较已经实际使用之后，我选择了<code>MGJRouter</code>这款蘑菇街开源的组件应用到项目中。为什么会选择<code>MGJRouter</code>这款组件呢，其实理由就跟他简单的介绍一样，高效、灵活。</p>
<p>来说一说这个基本的使用方式，首先你得跟后台约定推送的参数，比如我在跟后台的约定里，参数名就是<code>url</code>，那么我在拿到推送的<code>userInfo</code>时，就需要把<code>url</code>解析出来。在</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">application</span><span class="params">(application: UIApplication, didReceiveRemoteNotification userInfo: [NSObject : AnyObject], fetchCompletionHandler completionHandler: <span class="params">(UIBackgroundFetchResult)</span></span></span> -&gt; <span class="type">Void</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">application</span><span class="params">(application: UIApplication, didReceiveRemoteNotification userInfo: [NSObject : AnyObject])</span></span></div></pre></td></tr></table></figure>
<p> 这两个方法中，你可以获取到<code>userInfo</code>,例如后端给我传了这样的推送消息</p>
 <figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">[aps: &#123;</div><div class="line">    alert = "\U6d4b\U8bd5\U7cfb\U7edf\U6d88\U606f";</div><div class="line">    badge = 1;</div><div class="line">    category = system;</div><div class="line">    sound = "";</div><div class="line">&#125;, redirect: &#123;</div><div class="line">    data = "&lt;null&gt;";</div><div class="line">    target = article;</div><div class="line">    "target_id" = 5397;</div><div class="line">    "target_url" = "lix://cms/articles/3333";</div><div class="line">&#125;, _j_msgid: 5228988433]</div></pre></td></tr></table></figure>
<p> 很清楚的看到我们需要拿到<code>target_url</code>这个字段，至于怎么解析JSON，我就不啰嗦了，假设此时我们已经拿到了<code>url</code>，<code>url</code>其实为 <code>lix://cms/articles/:id</code>这个格式，<code>3333</code>是我们需要根据这个id跳转到的文章界面。</p>
 <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#pragma mark - 推送地址</span></div><div class="line"><span class="keyword">static</span> <span class="built_in">NSString</span> *ARTICLES_URL = <span class="string">@"lix://cms/articles/:id"</span>;   <span class="comment">//资讯详情</span></div></pre></td></tr></table></figure>
<p> 在定义好<code>url</code>的情况下，我们需要先用<code>MGJRouter</code>注册我们的<code>url</code>，</p>
 <figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">+ (<span class="keyword">void</span>)registerArticlePush &#123;</div><div class="line">    [MGJRouter registerURLPattern:ARTICLES_URL toHandler:^(<span class="built_in">NSDictionary</span> *routerParameters) &#123;</div><div class="line">       <span class="comment">//打印URL</span></div><div class="line">        LixLog(<span class="string">@"routerParameterURL:%@"</span>, routerParameters[MGJRouterParameterURL]);</div><div class="line">        <span class="comment">//获取URL中的id</span></div><div class="line">        <span class="built_in">NSString</span> *<span class="keyword">id</span> = routerParameters[<span class="string">@"id"</span>];</div><div class="line">        ArticleModel *model = [[ArticleModel alloc] init];</div><div class="line">        model._id = <span class="keyword">id</span>;</div><div class="line">        ArticleDetailViewController *articleViewController = [[ArticleDetailViewController alloc] init];</div><div class="line">        articleViewController.articleModel = model;</div><div class="line">        <span class="comment">//界面跳转</span></div><div class="line">        [LixObjcRouter pushController:articleViewController];</div><div class="line">    &#125;];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p> 这段代码可以当成一个完整的业务逻辑的范例，在写好业务逻辑之后，我们需要去<code>AppDelegate</code>的<code>func application(application: UIApplication, didFinishLaunchingWithOptions launchOptions: [NSObject: AnyObject]?) -&gt; Bool</code>里注册<code>url</code>。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="type">LixObjcRouter</span>.registerArticlePush()</div></pre></td></tr></table></figure>
<p>做完这些之后，咱们只要</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">application</span><span class="params">(application: UIApplication, didReceiveRemoteNotification userInfo: [NSObject : AnyObject], fetchCompletionHandler completionHandler: <span class="params">(UIBackgroundFetchResult)</span></span></span> -&gt; <span class="type">Void</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">application</span><span class="params">(application: UIApplication, didReceiveRemoteNotification userInfo: [NSObject : AnyObject])</span></span></div></pre></td></tr></table></figure>
<p>这两个方法里处理推送通知就好了，非常简单的一个<code>Api</code>。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[MGJRouter openURL:url];</div></pre></td></tr></table></figure>
<p>到这里，推送之后的页面跳转也就差不多完成了，只要再注意<code>badge</code>的数值处理，前台时推送通知的处理等情况就可以了。</p>
<p>用完蘑菇街的<code>Router</code>组件，又让我想接着啰嗦上次的组件化的思考了，用完这种方式，我还是觉得，如果把这个框架引入进行组件化，那么每次启动，都必须去注册这些<code>url</code>，如果小工程也没有组件化的必要，可是大工程，管理<code>url</code>又是一件费神的事情。</p>
<p>所以推送跳转，我选择<code>MGJRouter</code>,因为足够方便高效，可是组件化的道路，我更看好<a href="https://github.com/casatwy/CTMediator" target="_blank" rel="external">CTMediator</a>这样彻底解耦的方式。感兴趣的自己搜索研究吧。</p>
<p>年前最后一篇，新年快乐，鸡年大吉吧。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;眨眼2016年就这么走到了结尾，再过两天新年就要开始了。回顾从2016年开始养成的写博客的习惯，一直能延续下来，保持了一整年，还是比较欣慰的一件事情。希望2017年自己的技术能够继续稳步的提升。&lt;/p&gt;
&lt;p&gt;今天在这2016年的最后一篇博客里，咱来聊聊推送通知的跳转。&lt;/p&gt;
&lt;p&gt;当推送通知到达时，点击推送通知跳转到指定界面，是很多应用都会碰到的一个需求，而要实现这个功能，解决的方法也很多，若是去谷歌搜索，有一个万能跳转的文章可能会进入您的眼帘，但是我实际的去看了这个项目的源码之后，感觉这个库有一定的局限性，用&lt;strong&gt;runtime&lt;/strong&gt;实现跳转这不假，但是在请求字段里加上了&lt;code&gt;ViewController&lt;/code&gt;的类名，这其实就是局限的地方了，毕竟除了服务咱们&lt;strong&gt;iOS&lt;/strong&gt;端，你也得考虑考虑安卓端的攻城狮不是，然而如果你换一个约定的字段再来解析，那倒不如用&lt;code&gt;URL&lt;/code&gt;来作为判断依据更为方便。&lt;/p&gt;
    
    </summary>
    
    
      <category term="iOS开发" scheme="http://yoursite.com/tags/iOS%E5%BC%80%E5%8F%91/"/>
    
      <category term="推送" scheme="http://yoursite.com/tags/%E6%8E%A8%E9%80%81/"/>
    
      <category term="组件化" scheme="http://yoursite.com/tags/%E7%BB%84%E4%BB%B6%E5%8C%96/"/>
    
  </entry>
  
</feed>
